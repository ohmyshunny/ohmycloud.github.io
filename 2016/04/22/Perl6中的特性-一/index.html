<!doctype html>



  


<html class="theme-next muse use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|monospace:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Examples,特性," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="基础
数组
切片, 索引, Zen
12345678910111213141516171819202122232425262728293031use v6;my @primes = (2,3,5,7,11,13,17,19,23);   # an array gets filled like in Perl 5# my @primes =  2,3,5,7,11,13,17,19,23 ; # s">
<meta property="og:type" content="article">
<meta property="og:title" content="Perl 6 中的特性(一)">
<meta property="og:url" content="https://ohmycloud.github.io/2016/04/22/Perl6中的特性-一/index.html">
<meta property="og:site_name" content="Perl 6 青春小站">
<meta property="og:description" content="基础
数组
切片, 索引, Zen
12345678910111213141516171819202122232425262728293031use v6;my @primes = (2,3,5,7,11,13,17,19,23);   # an array gets filled like in Perl 5# my @primes =  2,3,5,7,11,13,17,19,23 ; # s">
<meta property="og:updated_time" content="2016-10-23T16:44:09.754Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Perl 6 中的特性(一)">
<meta name="twitter:description" content="基础
数组
切片, 索引, Zen
12345678910111213141516171819202122232425262728293031use v6;my @primes = (2,3,5,7,11,13,17,19,23);   # an array gets filled like in Perl 5# my @primes =  2,3,5,7,11,13,17,19,23 ; # s">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Muse',
    sidebar: {"position":"left","display":"hide"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="https://ohmycloud.github.io/2016/04/22/Perl6中的特性-一/"/>

  <title> Perl 6 中的特性(一) | Perl 6 青春小站 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Perl 6 青春小站</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>
 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Perl 6 中的特性(一)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2016-04-22T00:00:00+08:00" content="2016-04-22">
              2016-04-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/Perl-6/" itemprop="url" rel="index">
                    <span itemprop="name">Perl 6</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
              <span class="post-comments-count">
                &nbsp; | &nbsp;
                <a href="/2016/04/22/Perl6中的特性-一/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2016/04/22/Perl6中的特性-一/" itemprop="commentsCount"></span>
                </a>
              </span>
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><hr>
<h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><hr>
<p>切片, 索引, Zen</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my @primes = (2,3,5,7,11,13,17,19,23);   # an array gets filled like in Perl 5</div><div class="line"># my @primes =  2,3,5,7,11,13,17,19,23 ; # same thing, since unlike P5 round braces just do group</div><div class="line"># my @primes = &lt;2 3 5 7 11 13 17 19 23&gt;; # dito, &lt;&gt; is the new qw()</div><div class="line"></div><div class="line">say @primes[];                           # 2 3 5 7 11 13 17 19 23</div><div class="line">my $arrayref = [2,3,5,7,11,13,17,19,23]; # in scalar context you get automatically a reference</div><div class="line">say @$arrayref;                          # 2 3 5 7 11 13 17 19 23</div><div class="line"></div><div class="line">my $arrayref = item @primes;             # same thing, more explicit</div><div class="line">say $arrayref;</div><div class="line"></div><div class="line">my $arrayref = [13,];                    # comma is the new array generator</div><div class="line">say $arrayref;</div><div class="line"></div><div class="line">my @primes = 2;                          # array with one element</div><div class="line">my @primes = [2,3,5,7,11,13,17,19,23];   # array with one element (arrayref)</div><div class="line">say @primes;                             # 2 3 5 7 11 13 17 19 23</div><div class="line"></div><div class="line">my @dev    = &#123;&apos;dan&apos; =&gt; &apos;parrot&apos;&#125;;        # array with one element (hashref)</div><div class="line">say @dev;                                # (&quot;dan&quot; =&gt; &quot;parrot&quot;).hash</div><div class="line"></div><div class="line"></div><div class="line">my @data   = [1..5],[6..10],[11..15];    # Array of Arrays (AoA)</div><div class="line">say @data.perl;                          # Array.new([1, 2, 3, 4, 5], [6, 7, 8, 9, 10], [11, 12, 13, 14, 15])</div><div class="line"></div><div class="line"># my @list   = lol @data;                # no change</div><div class="line"># say @list.perl;</div><div class="line">my @list   = flat @data;                 # returns 1..15</div><div class="line">say @list;                               # 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15</div></pre></td></tr></table></figure>
<a id="more"></a>
<p>函数式编程:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">my @array = 1,3,5,7,9;</div><div class="line"></div><div class="line">my @arrayplus3 = map( *+3, @array);</div><div class="line">say @arrayplus3;</div><div class="line"></div><div class="line">my @arrayplusab = map( *+*+3, @array,11);</div><div class="line">say @arrayplusab;</div></pre></td></tr></table></figure>
<p>操作数组中的元素: elems, end, cat, shift, unshift, push, pop, splice, delete, exists, pick, roll…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line">my @rray=17,21,34,47,58,69;</div><div class="line"></div><div class="line">say &apos;the array has element&apos; if  ? @rray;   # boolean context, Bool::True if array has any value in it, even if its a 0</div><div class="line">say &apos;the array has &apos;,+ @rray ~&apos; element&apos;;  # numeric context, number of elements (like in Perl 5 scalar @a)</div><div class="line">say ~ @rray;              # string context, you get content of all cells, stringified and joined, same as &quot;@primes[]&quot;</div><div class="line"></div><div class="line">say @rray.elems;          # same as + @rray</div><div class="line">say @rray.end;            # number of the last element, equal to @rray.elems-1, # 5</div><div class="line"># say @rray.cat;          # same ~ @rray</div><div class="line">say @rray.join(&apos;-&apos;);      # also same result, you can put another string as parameter that gets between all values</div><div class="line">say @rray.unshift(7);     # prepend one value to the array, # 7 1 2 3 4 5 6</div><div class="line">say @rray.shift;          # remove the first value and return it # 7</div><div class="line">say @rray.push(8);        # add one value on the end # 1 2 3 4 5 6 8</div><div class="line">say @rray.pop;            # remove one value from the end and return it # 8</div><div class="line"></div><div class="line">my $n=2;</div><div class="line">my $pos=1;</div><div class="line">my @ind=0..3;</div><div class="line">say @rray.splice($pos,$n);# remove on $pos $n values and replace them with values that follow that two parameter</div><div class="line">say @rray:delete(@ind);   # delete all cell with indecies of @ind # 1 4 5 6</div><div class="line">say @rray:exists(@ind);   # Bool::True if all indecies of @ind have a value (can be 0 or &apos;&apos;)</div><div class="line"></div><div class="line">say &apos;-&apos; x 18;</div><div class="line">say @rray;</div><div class="line">say @rray.pick([$n]);     # return $n (default is 1) randomly selected values, without duplication</div><div class="line">say @rray.roll([$n]);     # return $n (default is 1) randomly selected values, duplication possible (就像掷筛子)</div><div class="line">say @rray.reverse;        # all elements in reversed order</div><div class="line">say @rray.rotate(-$n);    # returns a list where $n times first item is taken to last position if $n is positive, if negative the other way around</div><div class="line"># @rray.sort($coderef); # returns a sorted list by a userdefined criteria, default is alphanumerical sorting</div><div class="line">say @rray.min;            # numerical smallest value of that array</div><div class="line">say @rray.max;            # numerical largest value of that array</div><div class="line">my ($a,$b)= @rray.minmax;  # both at once, like in .sort . min or .max a sorting algorith can be provided</div><div class="line">say $a,&quot;   $b&quot;;</div><div class="line"># @rray.map($coderef);  # high oder map function, runs $coderef with every value as $_ and returns the list or results</div><div class="line"># @rray.classify($cr);  # kind of map, but creates a hash, where keys are the results of $cr and values are from @rray</div><div class="line"># @rray.categorize($cr);# kind of classify, but closure can have no (Nil) or several results, so a key can have a list of values</div><div class="line">say @rray.grep(&#123;$_&gt;40&#125;);   # high order grep, returns only these elements that pass a condition ($cr returns something positive)</div><div class="line"># @rray.first($coder);  # kind of grep, return just the first matching value</div><div class="line"># say @rray.zip;            # join arrays by picking first element left successively from here and then there</div></pre></td></tr></table></figure>
<p>数组的索引:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my  @primes=&lt;1 3 5 7 9 11 13 15 17&gt;;</div><div class="line">say @primes;                       # all values as list</div><div class="line">say @primes.values;                # same thing</div><div class="line">say @primes.keys;                  # list of all indices</div><div class="line">say &quot;@primes[]&quot;;                   # insert all values in a string, uses [] as distinction from mail adresses</div><div class="line">my  $prime = @primes[0];           # get the first prime</div><div class="line">say $prime;</div><div class="line"></div><div class="line">my $last_prime = @primes[*-1];    # get the last one</div><div class="line">say $last_prime;</div><div class="line"></div><div class="line">my @some = @primes[2..5];         # get several</div><div class="line">say @some;</div><div class="line"></div><div class="line">my @data   = [1..5],[6..10],[11..15];  # Array of Arrays (AoA)</div><div class="line">my $cell = @data[1][2];                # get 8, third value of second value (list)</div><div class="line">say $cell;</div><div class="line"></div><div class="line">my  $same_cell = @data[1,2];           # same thing, shorten syntax</div><div class="line">say $same_cell;                        # 6 7 8 9 10 11 12 13 14 15</div><div class="line"></div><div class="line">my @numbers = @data[1];                # get a copy of the second subarray (6..10)</div><div class="line">say @numbers;</div><div class="line">my @copy = @data;                      # copy the whole AoA, no more reference passing, use binding instead</div><div class="line">say @copy.perl;</div></pre></td></tr></table></figure>
<p>二维数组:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my @original = [1,2],[3,4];</div><div class="line">say @original.perl;</div><div class="line">my $copy = @original[0]; # $copy points to [1,2]</div><div class="line">say $copy;</div><div class="line">@original[0][0] = &apos;fresh stuff&apos;; # $copy[0] holds still 1</div><div class="line">say @original;</div><div class="line">say $copy;</div></pre></td></tr></table></figure>
<p>根据数组中元素的字符数进行归类:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">my @names = &lt;Patrick Jonathan Larry Moritz Audrey&gt;;</div><div class="line">say .key, &quot;\t&quot;, ~.values</div><div class="line">    for @names.classify( *.chars );</div><div class="line"># 根据字符串的字符个数分类</div><div class="line"># Output:</div><div class="line"># 7	Patrick</div><div class="line"># 8	Jonathan</div><div class="line"># 5	Larry</div><div class="line"># 6	Moritz Audrey</div></pre></td></tr></table></figure>
<p>根据字符串中单词数进行归类并按单词个数多少进行排序</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">#.say for slurp(&quot;README.txt&quot;)\           # whole file into string</div><div class="line">#         .words()\                      # split into list of words</div><div class="line">#         .classify( *.Str );</div><div class="line"></div><div class="line">my @a = slurp(&quot;README.txt&quot;).words;</div><div class="line"># .say  for @a.classify( *.Str );</div><div class="line"># output:</div><div class="line">#  可见输出的是一个散列</div><div class="line"># that =&gt; that that that that that that that that that that that</div><div class="line"># the =&gt; the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the the</div><div class="line"># is =&gt; is is is is is is is is is is is is is is is is</div><div class="line">my %hash = @a.classify( *.Str );</div><div class="line">for %hash.sort(&#123;-.value.elems&#125;).hash.kv.[^20] -&gt; $key, $value &#123;</div><div class="line">    say $key ,&quot;\t&quot;, $value.elems;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>\</code> 的作用是续行符, 隐藏它后面的空白符:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">.say for slurp(&quot;README.txt&quot;)\           # whole file into string</div><div class="line">         .words()\                      # split into list of words</div><div class="line">         .classify( *.Str )\            # group words with multiplicity</div><div class="line">         .map(&#123;;.key =&gt; .value.elems &#125;)\</div><div class="line">                                        # turn lists into lengths</div><div class="line">         .sort( &#123; -.value &#125; )\          # sort descending</div><div class="line">         .[ ^10 ];                      # 10 most common words</div><div class="line"></div><div class="line"># Output:</div><div class="line"># the =&gt; 40</div><div class="line"># to =&gt; 21</div><div class="line"># is =&gt; 16</div><div class="line"># a =&gt; 16</div><div class="line"># that =&gt; 11</div><div class="line"># be =&gt; 11</div><div class="line"># stack =&gt; 10</div><div class="line"># implementation =&gt; 8</div><div class="line"># link =&gt; 8</div><div class="line"># it =&gt; 7</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my $range = &apos;a&apos; .. &apos;f&apos;;</div><div class="line">for $range.list -&gt; $elem &#123;</div><div class="line">    say $elem;</div><div class="line">&#125;</div><div class="line"></div><div class="line">.say for @( $range );</div><div class="line"># .say for $list.list;</div><div class="line">.say for $range.flat;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my @a=&lt;aa bb cc dd ee ff &gt;;</div><div class="line">for @a -&gt; $x,$y,$z &#123;</div><div class="line">say $x,$y,$z;</div><div class="line">&#125;</div><div class="line">say $*PROGRAM_NAME;</div><div class="line"></div><div class="line">aabbcc</div><div class="line">ddeeff</div><div class="line">three.p6</div></pre></td></tr></table></figure>
<h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">my $a = bag &lt;a a a b b c&gt;;</div><div class="line">my $b = bag &lt;a b b b&gt;;</div><div class="line"></div><div class="line">say $a (|) $b;</div><div class="line">say $a (&amp;) $b;</div><div class="line">say $a (+) $b;</div><div class="line">say $a (.) $b;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"># my %words := KeyBag.new;</div><div class="line"># for slurp.comb(/\w+/).map(*.lc) -&gt; $word &#123;</div><div class="line">    # %words&#123;$word&#125;++;</div><div class="line"># &#125;</div><div class="line">my %words := Bag.new(slurp.comb(/\w+/).map(*.lc));</div><div class="line"></div><div class="line">say &quot;%words&#123;&#125;&quot;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">my %words;</div><div class="line">for slurp.comb(/\w+/).map(*.lc) -&gt; $word &#123;</div><div class="line">    %words&#123;$word&#125;++;</div><div class="line">&#125;</div><div class="line"></div><div class="line">for %words.pairs.sort(-*.value).map(&#123; $_.key, $_.value &#125;) -&gt; $word, $count &#123;</div><div class="line">    say &quot;$word: $count&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">my %words := Bag.new(slurp.comb(/\w+/).map(*.lc));</div><div class="line"># say %words.pairs.list.join(&quot;\n&quot;);</div><div class="line"># .say for %words.pairs.sort(-*.value);  # 按键值从大到小排序，然后打印，- 号是降序</div><div class="line"># &quot;and&quot; =&gt; 12</div><div class="line"># &quot;the&quot; =&gt; 11</div><div class="line"># &quot;our&quot; =&gt; 6</div><div class="line"># &quot;be&quot; =&gt; 6</div><div class="line"># &quot;man&quot; =&gt; 6</div><div class="line"># &quot;your&quot; =&gt; 6</div><div class="line"># &quot;us&quot; =&gt; 5</div><div class="line"># &quot;you&quot; =&gt; 5</div><div class="line"># &quot;for&quot; =&gt; 5</div><div class="line"># &quot;o&quot; =&gt; 5</div><div class="line"># &quot;to&quot; =&gt; 5</div><div class="line"></div><div class="line">for %words.pairs.sort(-*.value).map(&#123; $_.key, $_.value &#125;) -&gt; $word, $count &#123;</div><div class="line">    say &quot;$word: $count&quot;;</div><div class="line">&#125;</div><div class="line"># .say for %words.pairs.sort(-*.value).fmt(&quot;%-15s=&gt;%4d\n&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">my %words := bag slurp.comb(/\w+/).map(*.lc);</div><div class="line"></div><div class="line">for %words.pairs.sort(-*.value).map(&#123; $_.key, $_.value &#125;) -&gt; $word, $count &#123;</div><div class="line">    say &quot;$word: $count&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line">my %dev =  &apos;pugs&apos;=&gt;&apos;audreyt&apos;, &apos;pct&apos;=&gt;&apos;pm&apos;, &quot;STD&quot;=&gt;&apos;larry&apos;;</div><div class="line">my %same_dev = :rakudo(&apos;jnthn&apos;), :testsuite(&apos;moritz&apos;);            # adverb (pair) syntax works as well</div><div class="line">my %too_dev = (&apos;audreyt&apos;, &apos;pugs&apos;, &apos;pm&apos;, &apos;pct&apos;, &apos;larry&apos;, &quot;STD&quot;);   # lists get autoconverted in hash context</div><div class="line">my %compiler = Parrot =&gt; &#123;Rakudo =&gt; &apos;jnthn&apos;&#125;, SMOP =&gt; &#123;Mildew =&gt; &apos;ruoso&apos;&#125;;       # hash of hashes (HoH)</div><div class="line">say %dev.perl;</div><div class="line">say %same_dev.perl;</div><div class="line">say %too_dev.perl;</div><div class="line">say %compiler.perl;</div><div class="line"></div><div class="line"># Hash Slices</div><div class="line">my $name=&apos;pugs&apos;;</div><div class="line">my $value = %dev&#123;&apos;pugs&apos;&#125;;      # just give me the value related to that key, like in P5</div><div class="line">my $value1 = %dev&lt;STD&gt;;         # &lt;&gt; autoquotes like qw() in P5</div><div class="line">my $value2 = %dev&lt;&lt;$name&gt;&gt;;     # same thing, just with eval</div><div class="line">say $value;</div><div class="line">say $value2;</div><div class="line"></div><div class="line">my @values = %dev&#123;&apos;pugs&apos;, &apos;STD&apos;&#125;;</div><div class="line">my @values2 = %dev&lt;pugs STD&gt;;</div><div class="line">my @values3 = %dev&lt;&lt;pugs STD $name&gt;&gt;;</div><div class="line">say @values;</div><div class="line">say @values2;</div><div class="line">say @values3;</div><div class="line"></div><div class="line">say %compiler&lt;Parrot&gt;&lt;Rakudo&gt;; # value in a HoH, returns &apos;jnthn&apos;</div><div class="line">say %compiler&lt;SMOP&gt;;           # returns the Pair: Mildew =&gt; &apos;ruoso&apos;</div><div class="line"></div><div class="line"># %dev   &#123;&apos;audrey&apos;&#125;;           # error, spaces between varname and braces (postcircumfix operator) are no longer allowed</div><div class="line">say %dev\  &#123;&apos;pugs&apos;&#125;;           # works, quote the space</div><div class="line"># %dev   .&lt;dukeleto&gt;;          # error</div><div class="line">say %dev\ .&#123;&apos;pugs&apos;&#125;;           # works too, &quot;long dot style&quot;, because its its an object in truth</div><div class="line">say %dev.&#123;&apos;pugs&apos;&#125;;</div><div class="line"></div><div class="line"></div><div class="line"># Hash Methods</div><div class="line">say &apos;this hash has some pairs&apos; if ? %dev;                    # bool context, true if hash has any pairs</div><div class="line">say &apos;this hash has &apos;~ + %dev ~&apos; pairs&apos;;                      # numeric context, returns number of pairs(keys)</div><div class="line">say ~ %dev;                     # string context, nicely formatted 2 column table using \t and \n</div><div class="line"></div><div class="line">my $table = %dev;               # same as ~ %dev</div><div class="line">say $table;                     # (&quot;pugs&quot; =&gt; &quot;audreyt&quot;, &quot;pct&quot; =&gt; &quot;pm&quot;, &quot;STD&quot; =&gt; &quot;larry&quot;).hash</div><div class="line">say %dev.say;                   # stringified, but only $key and $value are separated by \t  #(&quot;pugs&quot; =&gt; &quot;audreyt&quot;, &quot;pct&quot; =&gt; &quot;pm&quot;, &quot;STD&quot; =&gt; &quot;larry&quot;).hash</div><div class="line">my  @pairs = %dev;              # list of all containing pairs</div><div class="line">say @pairs;                     # &quot;pugs&quot; =&gt; &quot;audreyt&quot; &quot;pct&quot; =&gt; &quot;pm&quot; &quot;STD&quot; =&gt; &quot;larry&quot;</div><div class="line">say %dev.pairs;                 # same thing in all context  # &quot;pugs&quot; =&gt; &quot;audreyt&quot; &quot;pct&quot; =&gt; &quot;pm&quot; &quot;STD&quot; =&gt; &quot;larry&quot;</div><div class="line">say %dev.elems;                 # same as + %dev or + %dev.pairs  # 3</div><div class="line">say %dev.keys;                  # returns the list with all keys</div><div class="line">say %dev.values;                # list of all values</div><div class="line">say %dev.kv;                    # flat list with key1, value1, key 2 ...</div><div class="line">say %dev.invert;                # reverse all key =&gt; value relations</div><div class="line">say %dev.push(@pairs);          # inserts a list of pairs, if a key is already present in %dev, both values gets added to an array</div><div class="line"># (&quot;pugs&quot; =&gt; [&quot;audreyt&quot;, &quot;audreyt&quot;], &quot;pct&quot; =&gt; [&quot;pm&quot;, &quot;pm&quot;], &quot;STD&quot; =&gt; [&quot;larry&quot;, &quot;larry&quot;]).hash</div><div class="line"></div><div class="line">my @another_pairs=&apos;Rakudo&apos;=&gt;&apos;Perl6&apos;;</div><div class="line">say %same_dev.push(@another_pairs);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"># You can also destructure hashes (and classes, which you&apos;ll learn about later !)</div><div class="line"># The syntax is basically `%hash-name (:key($variable-to-store-value-in))`.</div><div class="line"># The hash can stay anonymous if you only need the values you extracted.</div><div class="line">sub key-of(% (:value($val), :qua($qua))) &#123;</div><div class="line">  say &quot;Got val $val, $qua times.&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Then call it with a hash: (you need to keep the brackets for it to be a hash)</div><div class="line">key-of(&#123;value =&gt; &apos;foo&apos;, qua =&gt; 1&#125;);</div><div class="line">my %hash = value =&gt; &apos;Perl6&apos;, qua =&gt; &apos;2016&apos;;</div><div class="line">key-of(%hash); # the same (for an equivalent `%hash`);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">my $bag = bag &quot;red&quot; =&gt; 2, &quot;blue&quot; =&gt; 10;</div><div class="line">say $bag.roll(10); # 随机生成 10 组</div><div class="line">say $bag.pick(*).join(&quot;\n&quot;);</div><div class="line"></div><div class="line">$bag = bag &quot;red&quot; =&gt; 20000000000000000001, &quot;blue&quot; =&gt; 100000000000000000000;</div><div class="line">say $bag.roll(10);</div><div class="line">say $bag.pick(10).join(&quot; &quot;);</div></pre></td></tr></table></figure>
<h3 id="Bind"><a href="#Bind" class="headerlink" title="Bind"></a>Bind</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line">my @a := 1..Inf;</div><div class="line">say @a[^10]; # 1 2 3 4 5 6 7 8 9 10</div><div class="line"></div><div class="line">my @primes  := @a.grep(*.is-prime);</div><div class="line">say @primes[^10]; # 2 3 5 7 11 13 17 19 23 29</div><div class="line"></div><div class="line">my @nprimes := @primes.map(&#123; &quot;&#123;++state $n&#125;: $_&quot; &#125;);</div><div class="line">.say for @nprimes[^10];</div><div class="line"></div><div class="line">.say for (1..Inf</div><div class="line">    ==&gt; grep(*.is-prime)</div><div class="line">    ==&gt; map(&#123; &quot;&#123;++state $n&#125;: $_&quot; &#125;)</div><div class="line">    )[^10];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">my @a := (1, 2, 3);</div><div class="line">say @a.WHAT;</div><div class="line">say @a.elems;</div><div class="line"></div><div class="line">my @b = (1, 2, 3);</div><div class="line">@b[0] := my $x;</div><div class="line">$x = 42;</div><div class="line">say @b;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my $original = 5;say $original;</div><div class="line">my $mirror;</div><div class="line">$original := $mirror;       # normal binding, done on runtime</div><div class="line"></div><div class="line">say $mirror;</div><div class="line"></div><div class="line">$original ::= $mirror;      # same thing, but done during compile time</div><div class="line">say $mirror;</div><div class="line">$original = 3;</div><div class="line">say $mirror;                # prints 3</div><div class="line">$original =:= $mirror;      # true, because their bound together</div><div class="line">$original === $mirror;      # alsotrue, because content and type are equal</div></pre></td></tr></table></figure>
<h2 id="IO"><a href="#IO" class="headerlink" title="IO"></a>IO</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">my $total = 0;</div><div class="line">for @files -&gt; $filename &#123;</div><div class="line">    $total += lines($filename.IO).grep(</div><div class="line">        &#123; $_ !~~ /&lt;&amp;insigline&gt;/ &#125;</div><div class="line">).elems;</div><div class="line"> CATCH &#123;</div><div class="line">        when X::IO &#123;</div><div class="line">            note &quot;Couldn&apos;t read $filename&quot;;</div><div class="line">&#125; &#125;</div><div class="line">&#125;</div><div class="line">say $total;</div><div class="line"># As CATCH goes inside of the scope,we can see the scope&apos;s lexicals!</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># create a file</div><div class="line">my $f = open &quot;foo&quot;,:w;</div><div class="line">$f.print(time);</div><div class="line">$f.close;</div><div class="line"></div><div class="line"># copy</div><div class="line">my $io = IO::Path.new(&quot;foo&quot;);</div><div class="line">$io.copy(&quot;foo2&quot;);</div><div class="line"></div><div class="line"># clean up</div><div class="line">unlink (&quot;foo2&quot;);</div><div class="line"></div><div class="line"># move</div><div class="line">$io.rename(&quot;foo2&quot;);</div><div class="line"></div><div class="line"># clean up</div><div class="line">unlink (&quot;foo2&quot;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># create a file</div><div class="line">my $f = open &quot;foo&quot;,:w;</div><div class="line">$f.print(time);</div><div class="line">$f.close;</div><div class="line"></div><div class="line">unlink &quot;foo&quot;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1428936330</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">1428936330</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my $fn =  $?FILE;</div><div class="line"></div><div class="line">my Instant $i = $fn.IO.accessed;</div><div class="line">my $dt = $i.to-posix;</div><div class="line"></div><div class="line">say :$dt.perl;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"># slurp 读入到数组后只是一个元素</div><div class="line">my @lines = slurp(&apos;3col.txt&apos;);</div><div class="line">say @lines.elems;</div><div class="line"></div><div class="line">my $fh = open(&apos;3col.txt&apos;);</div><div class="line">for $fh.lines -&gt; $line &#123;</div><div class="line">    say $line;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">﻿&gt; 15 + 27</div><div class="line">42</div><div class="line">&gt; &lt;beer vodka whisky&gt;.pick</div><div class="line">beer</div><div class="line">&gt; &lt;beer vodka whisky&gt;.pick(2)</div><div class="line">beer whisky</div><div class="line">&gt; (1, 1, *+* ... *)[20]</div><div class="line">10946</div><div class="line">&gt;  dir&gt;&gt;.path</div><div class="line">&gt; dir&gt;&gt;.path ==&gt; grep /\.p6$/</div><div class="line">REPL.p6 slides.p6</div><div class="line"></div><div class="line">&gt; type REPL.p6 | perl6 -e &quot;$*IN.slurp-rest.comb(/\w+/) ==&gt; sort *.chars ==&gt; @temp ==&gt; reverse @temp ==&gt; @reverse ==&gt; say @reverse</div><div class="line">&gt; type REPL.p6 | perl6 -e &quot;$*IN.slurp-rest.comb(/\w+/) ==&gt; sort *.chars ==&gt; reverse @() ==&gt; join \&quot;\n\&quot; ==&gt; say @()&quot;</div><div class="line">&gt; type Hamlet.txt | perl6 -e &quot;say [max] $*IN.slurp-rest.comb(/\d+/)&quot;</div><div class="line"></div><div class="line"># slurp reads a file into a scalar</div><div class="line">&gt; dir&gt;&gt;.path ==&gt; grep /\.p6$/ ==&gt; sort &#123; slurp($_).chars &#125;</div><div class="line">slurp_feed.p6 REPL.p6 slides.p6</div><div class="line"></div><div class="line"># lines reads the lines of a file into an array</div><div class="line">&gt; dir&gt;&gt;.path ==&gt; grep /\.p6$/ ==&gt; sort &#123; +lines($_) &#125;</div><div class="line">REPL.p6 slides.p6 slurp_feed.p6</div><div class="line"># 求出所有 words的和</div><div class="line">&gt; type 3col.txt | perl6 -e &quot;say [+] $*IN.lines&gt;&gt;.words&quot;</div><div class="line">&gt; type 3col.txt | perl6 -e &quot;say [+] $*IN.lines&gt;&gt;.words&gt;&gt;.elems # word 的个数</div><div class="line">&gt; type 3col.txt | perl6 -e &quot;say [+] $*IN.lines&gt;&gt;.words&gt;&gt;.[2]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my %words;</div><div class="line">for slurp.comb(/\w+/).map(*.lc) -&gt; $word &#123;</div><div class="line">    %words&#123;$word&#125;++;</div><div class="line">&#125;</div><div class="line">say %words:kv;</div></pre></td></tr></table></figure>
<h2 id="Classes"><a href="#Classes" class="headerlink" title="Classes"></a>Classes</h2><hr>
<p>Classes In Perl 6</p>
<p>使用带有 block 的 class 关键字引入一个类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class Puppy &#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>或使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class Puppy;</div><div class="line">...</div><div class="line">1;</div></pre></td></tr></table></figure>
<p>把类相关的东西<code>单独</code>写进一个文件.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">class Enemy &#123;</div><div class="line">    method attack-with-arrows   &#123; say &quot;peow peow peow&quot; &#125;</div><div class="line">    method attack-with-swords   &#123; say &quot;swish cling clang&quot; &#125;</div><div class="line">    method attack-with-fireball &#123; say &quot;sssSSS fwoooof&quot; &#125;</div><div class="line">    method attack-with-camelia  &#123; say &quot;flap flap RAWWR!&quot; &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 创建一个方法筛选器， 方法名以 attack-with- 开头</div><div class="line"># 对象的 ^methods 方法返回该对象所有的方法，包括自定义的方法</div><div class="line">my $selector = &#123; .name ~~ /^ &apos;attack-with-&apos; / &#125;;</div><div class="line">given Enemy.new -&gt; $e &#123;</div><div class="line">    my $attack-strategy</div><div class="line">        = $e.^methods().grep($selector).pick();</div><div class="line"></div><div class="line">    $e.$attack-strategy();           # call a random method</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">class Parent &#123;</div><div class="line">    method frob &#123;</div><div class="line">        say &quot;the parent class frobs&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Child is Parent &#123;</div><div class="line">    method frob &#123;</div><div class="line">        say &quot;the child&apos;s somewhat more fancy frob is called&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"># 对象的实际类型决定了要调用哪个方法</div><div class="line">my Parent $test;</div><div class="line">$test = Child.new;</div><div class="line">$test.frob;          # calls the frob method of Child rather than Parent</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">class Dog &#123;</div><div class="line">    has $.name is rw;</div><div class="line">    has $.color;</div><div class="line"></div><div class="line">    method kugo &#123;</div><div class="line">       say &quot;hello &quot;,$.name;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">my $pet = Dog.new(</div><div class="line">    name =&gt; &apos;Spot&apos;, color =&gt; &apos;Black&apos;</div><div class="line">);</div><div class="line">$pet.kugo();</div><div class="line">$pet.name = &apos;Fido&apos;; # OK</div><div class="line">$pet.kugo();</div><div class="line">$pet.color = &apos;White&apos;; # Fails</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line">class Journey &#123;</div><div class="line">    has $.origin;</div><div class="line">    has $.destination;</div><div class="line">    has @!travellers;</div><div class="line">    has $.notes is rw;</div><div class="line"></div><div class="line">    method add_traveller($name) &#123;</div><div class="line">        if $name ne any(@!travellers) &#123;</div><div class="line">            push @!travellers, $name;</div><div class="line">        &#125; else &#123;</div><div class="line">            warn &quot;$name is already going on the journey!&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method describe() &#123;</div><div class="line">        &quot;From $!origin to $!destination&quot;;</div><div class="line">    &#125;</div><div class="line">    # Private method</div><div class="line">    method !do-something-private($x) &#123;</div><div class="line">       ($x + 120)*0.88; # 先加价，再打折！</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method price($x) &#123;</div><div class="line">        self!do-something-private(2*$x);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">my $vacation = Journey.new(</div><div class="line">    origin      =&gt; &apos;China&apos;,</div><div class="line">    destination =&gt; &apos;Sweden&apos;,</div><div class="line">    notes       =&gt; &apos;Pack hiking&apos;</div><div class="line">);</div><div class="line"></div><div class="line">say $vacation.origin;</div><div class="line">$vacation.notes = &apos;Pack hiking gear and sunglasses!&apos;;</div><div class="line">say $vacation.notes;</div><div class="line">$vacation.add_traveller(&apos;Larry Wall&apos;);</div><div class="line">say $vacation.price(40);</div><div class="line">$vacation.add_traveller(&apos;Larry Wall&apos;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">use MethodModifiers;</div><div class="line">class C &#123;</div><div class="line">method m() is before &#123; say &quot;before&quot;; &#125; method m() &#123; say &quot;in the method&quot;; &#125; method m() is after &#123; say &quot;after&quot;; &#125;</div><div class="line">&#125; C.m;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Journey &#123;</div><div class="line">    has $.origin;</div><div class="line">    has $.destination;</div><div class="line">    has @!travellers;</div><div class="line">    has $.notes is rw;</div><div class="line"></div><div class="line">    method add_traveller($name) &#123;</div><div class="line">        if $name ne any(@!travellers) &#123;</div><div class="line">            push @!travellers, $name;</div><div class="line">        &#125;</div><div class="line">        else &#123;</div><div class="line">            warn &quot;$name is already going on the journey!&quot;;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method describe() &#123;</div><div class="line">        &quot;From $!origin to $!destination&quot;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">class Point &#123;</div><div class="line">    has $.x;</div><div class="line">    has $.y = 2 * $!x;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $p = Point.new( x =&gt; 1, y =&gt; 2);</div><div class="line">say &quot;x: &quot;, $p.x;</div><div class="line">say &quot;y: &quot;, $p.y;</div><div class="line"></div><div class="line">my $p2 = Point.new( x =&gt; 5 );</div><div class="line"># the given value for x is used to calculate the right</div><div class="line"># value for y.</div><div class="line">say &quot;x: &quot;, $p2.x;</div><div class="line">say &quot;y: &quot;, $p2.y;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">class Journey &#123;</div><div class="line">    has $.origin;</div><div class="line">    has $.destination;</div><div class="line">    has @!travellers;</div><div class="line">    has $.notes;  # 没有添加 is rw 限制时, 属性默认是只读的!</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $j = Journey.new(</div><div class="line">    origin      =&gt; &apos;Sweden&apos;,</div><div class="line">    destination =&gt; &apos;China&apos;,</div><div class="line">    notes       =&gt; &apos;Be careful your money!&apos;</div><div class="line">);</div><div class="line"></div><div class="line">say $j.origin;</div><div class="line">say $j.destination;</div><div class="line">say $j.notes;</div><div class="line"></div><div class="line"># now, try to change notes</div><div class="line">$j.notes = &apos;gun nima dan&apos;; # Cannot modify an immutable Str</div><div class="line">say $j.notes;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Journey &#123;</div><div class="line">    has $.origin;</div><div class="line">    has $.destination;</div><div class="line">    has @!travellers;</div><div class="line">    has $.notes is rw;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Create a new instance of the class.</div><div class="line">my $vacation = Journey.new(</div><div class="line">    origin      =&gt; &apos;Sweden&apos;,</div><div class="line">    destination =&gt; &apos;Switzerland&apos;,</div><div class="line">    notes       =&gt; &apos;Pack hiking gear!&apos;</div><div class="line">);</div><div class="line"></div><div class="line"># 使用取值器, 这输出 Sweden.</div><div class="line">say $vacation.origin;</div><div class="line"># 使用 rw 存取器修改属性的值</div><div class="line">$vacation.notes = &apos;Pack hiking gear and sunglasses!&apos;;</div><div class="line">say $vacation.notes;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">class Paper   &#123; &#125;</div><div class="line">class Scissor &#123; &#125;</div><div class="line">class Stone   &#123; &#125;</div><div class="line"></div><div class="line">multi win(Paper   $a, Stone   $b) &#123; 1 &#125;</div><div class="line">multi win(Scissor $a, Paper   $b) &#123; 1 &#125;</div><div class="line">multi win(Stone   $a, Scissor $b) &#123; 1 &#125;</div><div class="line">multi win(Any     $a, Any     $b) &#123; 0 &#125;</div><div class="line"></div><div class="line">say win(Paper.new, Scissor.new); # 0</div><div class="line">say win(Stone.new, Stone.new); #0</div><div class="line">say win(Paper.new, Stone.new); #1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">class Point2D &#123;</div><div class="line">    has $.x;</div><div class="line">    has $.y;</div><div class="line"></div><div class="line">    submethod BUILD(:$!x, :$!y) &#123;</div><div class="line">        say &quot;Initalizing Point2D&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class InvertiblePoint2D is Point2D &#123;</div><div class="line">    submethod BUILD() &#123;</div><div class="line">        say &quot;Initilizing InvertiblePoint2D&quot;;</div><div class="line">    &#125;</div><div class="line">    method invert &#123;</div><div class="line">        self.new(x =&gt; - $.x, y =&gt; - $.y);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say InvertiblePoint2D.new( x =&gt; 1, y =&gt; 2);</div></pre></td></tr></table></figure>
<h2 id="Junctions"><a href="#Junctions" class="headerlink" title="Junctions"></a>Junctions</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">my @bad_ext = (&apos;plx&apos;, &apos;pm&apos;, &apos;pl&apos;, &apos;p6&apos;);</div><div class="line">my $file_ext = &apos;p6&apos;;</div><div class="line">if lc($file_ext) eq any(@bad_ext) &#123;</div><div class="line">    say &quot;$file_ext files is  allowed, You are a Perler&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my $filename = &quot;temp.txt&quot;;</div><div class="line">my $fh = open $filename, :w;</div><div class="line"></div><div class="line">for dir(test =&gt; all(/p6$/, /^&lt;-[._]&gt;/ )) -&gt; $file &#123;</div><div class="line">    $fh.say(“```perl66”);</div><div class="line">    my $string = slurp $file;</div><div class="line">    $fh.say($string);</div><div class="line">    $fh.say(“```”);</div><div class="line">    $fh.say();</div><div class="line">&#125;</div><div class="line"></div><div class="line">$fh.close;</div></pre></td></tr></table></figure>
<h2 id="Lazy-List"><a href="#Lazy-List" class="headerlink" title="Lazy List"></a>Lazy List</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my @integers = 1..*;</div><div class="line">    for @integers -&gt; $i &#123;</div><div class="line">        say $i;</div><div class="line">        last if $i % 17 == 0;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"># A list comprehension is a special syntax in some programming languages to describe lists. It is similar to the way mathematicians describe sets, with a set comprehension, hence the name.</div><div class="line"></div><div class="line"># Some attributes of a list comprehension are that:</div><div class="line"># 1. They should be distinct from (nested) for loops within the syntax of the language.</div><div class="line"># 2. They should return either a list or an iterator (something that returns successive members of a collection, in order).</div><div class="line"># 3. The syntax has parts corresponding to that of set-builder notation.</div><div class="line"></div><div class="line"># Write a list comprehension that builds the list of all Pythagorean triples with elements between 1 and n. If the language has multiple ways for expressing such a construct (for example, direct list comprehensions and generators), write one example for each.</div><div class="line"></div><div class="line">use v6;</div><div class="line"></div><div class="line">my $n = 20;</div><div class="line">my @list := gather for 1..$n -&gt; $x &#123;</div><div class="line">         for $x..$n -&gt; $y &#123;</div><div class="line">           for $y..$n -&gt; $z &#123;</div><div class="line">             take $x,$y,$z if $x*$x + $y*$y == $z*$z;</div><div class="line">           &#125;</div><div class="line">         &#125;</div><div class="line">       &#125;</div><div class="line">.say for  @list;</div><div class="line"></div><div class="line"># Note that gather/take is the primitive in Perl 6 corresponding to generators or coroutines in other languages. It is not, however, tied to function call syntax in Perl 6. We can get away with that because lists are lazy, and the demand for more of the list is implicit; it does not need to be driven by function calls.</div></pre></td></tr></table></figure>
<h2 id="Loops"><a href="#Loops" class="headerlink" title="Loops"></a>Loops</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div></pre></td><td class="code"><pre><div class="line">my $row-count = 6;</div><div class="line"></div><div class="line">constant $peg = &quot;*&quot;;</div><div class="line">constant @coin-icons = &quot;\c[UPPER HALF BLOCK]&quot;, &quot;\c[LOWER HALF BLOCK]&quot;;</div><div class="line"></div><div class="line">sub display-board(@positions, @stats is copy, $halfstep) &#123;</div><div class="line">    my $coin = @coin-icons[$halfstep.Int];</div><div class="line"></div><div class="line">    state @board-tmpl = &#123;</div><div class="line">        # precompute a board</div><div class="line">        my @tmpl;</div><div class="line">        sub out(*@stuff) &#123;</div><div class="line">            @tmpl.push: @stuff&gt;&gt;.ords.item;</div><div class="line">        &#125;</div><div class="line">        # three lines of space above</div><div class="line">        for (1..3) &#123;</div><div class="line">            out &quot;  &quot;, &quot; &quot; x (2 * $row-count);</div><div class="line">        &#125;</div><div class="line">        # $row-count lines of pegs</div><div class="line">        for ($row-count...1) Z (1...$row-count) -&gt; $spaces, $pegs &#123;</div><div class="line">            out &quot;  &quot;, &quot; &quot; x $spaces, ($peg xx $pegs).join(&quot; &quot;), &quot; &quot; x $spaces;</div><div class="line">        &#125;</div><div class="line">        # four lines of space below</div><div class="line">        for (1..4) &#123;</div><div class="line">            out &quot;  &quot;, &quot; &quot; x (2 * $row-count);</div><div class="line">        &#125;</div><div class="line">        @tmpl</div><div class="line">    &#125;();</div><div class="line"></div><div class="line">    my $midpos = $row-count + 2;</div><div class="line"></div><div class="line">    my @output;</div><div class="line">    &#123;</div><div class="line">        # collect all the output and output it all at once at the end</div><div class="line">        sub say(Str $foo) &#123;</div><div class="line">            @output.push: $foo, &quot;\n&quot;;</div><div class="line">        &#125;</div><div class="line">        sub print(Str $foo) &#123;</div><div class="line">            @output.push: $foo;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # make some space above the picture</div><div class="line">        say &quot;&quot; for ^10;</div><div class="line"></div><div class="line">        my @output-lines = map &#123; [map *.clone, @$_].item &#125;, @board-tmpl;</div><div class="line">        # place the coins</div><div class="line">        for @positions.kv -&gt; $line, $pos &#123;</div><div class="line">            next unless $pos.defined;</div><div class="line">            @output-lines[$line][$pos + $midpos] = $coin.ord;</div><div class="line">        &#125;</div><div class="line">        # output the board with its coins</div><div class="line">        for @output-lines -&gt; @line &#123;</div><div class="line">            say @line&gt;&gt;.chr.join(&quot;&quot;);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # show the statistics</div><div class="line">        my $padding = 0;</div><div class="line">        while any(@stats) &gt; 0 &#123;</div><div class="line">            $padding++;</div><div class="line">            print &quot;  &quot;;</div><div class="line">            @stats = do for @stats -&gt; $stat &#123;</div><div class="line">                given $stat &#123;</div><div class="line">                    when 1 &#123;</div><div class="line">                        print &quot;\c[UPPER HALF BLOCK]&quot;;</div><div class="line">                        $stat - 1;</div><div class="line">                    &#125;</div><div class="line">                    when * &lt;= 0 &#123;</div><div class="line">                        print &quot; &quot;;</div><div class="line">                        0</div><div class="line">                    &#125;</div><div class="line">                    default &#123;</div><div class="line">                        print &quot;\c[FULL BLOCK]&quot;;</div><div class="line">                        $stat - 2;</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            say &quot;&quot;;</div><div class="line">        &#125;</div><div class="line">        say &quot;&quot; for $padding...^10;</div><div class="line">    &#125;</div><div class="line">    say @output.join(&quot;&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub simulate($coins is copy) &#123;</div><div class="line">    my $alive = True;</div><div class="line"></div><div class="line">    sub hits-peg($x, $y) &#123;</div><div class="line">        if 3 &lt;= $y &lt; 3 + $row-count and -($y - 2) &lt;= $x &lt;= $y - 2 &#123;</div><div class="line">            return not ($x - $y) %% 2;</div><div class="line">        &#125;</div><div class="line">        return False;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    my @coins = Int xx (3 + $row-count + 4);</div><div class="line">    my @stats = 0 xx ($row-count * 2);</div><div class="line">    # this line will dispense coins until turned off.</div><div class="line">    @coins[0] = 0;</div><div class="line">    while $alive &#123;</div><div class="line">        $alive = False;</div><div class="line">        # if a coin falls through the bottom, count it</div><div class="line">        given @coins[*-1] &#123;</div><div class="line">            when *.defined &#123;</div><div class="line">                @stats[$_ + $row-count]++;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # move every coin down one row</div><div class="line">        for ( 3 + $row-count + 3 )...1 -&gt; $line &#123;</div><div class="line">            my $coinpos = @coins[$line - 1];</div><div class="line"></div><div class="line">            @coins[$line] = do if not $coinpos.defined &#123;</div><div class="line">                Nil</div><div class="line">            &#125; elsif hits-peg($coinpos, $line) &#123;</div><div class="line">                # when a coin from above hits a peg, it will bounce to either side.</div><div class="line">                $alive = True;</div><div class="line">                ($coinpos - 1, $coinpos + 1).pick;</div><div class="line">            &#125; else &#123;</div><div class="line">                # if there was a coin above, it will fall to this position.</div><div class="line">                $alive = True;</div><div class="line">                $coinpos;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        # let the coin dispenser blink and turn it off if we run out of coins</div><div class="line">        if @coins[0].defined &#123;</div><div class="line">            @coins[0] = Nil</div><div class="line">        &#125; elsif --$coins &gt; 0 &#123;</div><div class="line">            @coins[0] = 0</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        # smooth out the two halfsteps of the animation</div><div class="line">        my $start-time;</div><div class="line">        ENTER &#123; $start-time = now &#125;</div><div class="line">        my $wait-time = now - $start-time;</div><div class="line"></div><div class="line">        sleep 0.1 - $wait-time if $wait-time &lt; 0.1;</div><div class="line">        for @coin-icons.keys &#123;</div><div class="line">            sleep $wait-time max 0.1;</div><div class="line">            display-board(@coins, @stats, $_);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub MAIN($coins = 20, $peg-lines = 6) &#123;</div><div class="line">    $row-count = $peg-lines;</div><div class="line">    simulate($coins);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Main"><a href="#Main" class="headerlink" title="Main"></a>Main</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"> #!/usr/bin/env perl6</div><div class="line"></div><div class="line">    constant @months = &lt;January February March April May June July</div><div class="line">                        August September October November December&gt;;</div><div class="line">    constant @days = &lt;Su Mo Tu We Th Fr Sa&gt;;</div><div class="line"></div><div class="line"></div><div class="line">    sub center(Str $text, Int $width) &#123;</div><div class="line">        my $prefix = &apos; &apos; x ($width - $text.chars) div 2;</div><div class="line">        my $suffix = &apos; &apos; x $width - $text.chars - $prefix.chars;</div><div class="line">        return $prefix ~ $text ~ $suffix;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    sub MAIN(:$year = Date.today.year, :$month = Date.today.month) &#123;</div><div class="line">        my $dt = Date.new(:year($year), :month($month), :day(1) );</div><div class="line">        my $ss = $dt.day-of-week % 7;</div><div class="line">        my @slots = &apos;&apos;.fmt(&quot;%2s&quot;) xx $ss;</div><div class="line"></div><div class="line">        my $days-in-month = $dt.days-in-month;</div><div class="line">        for $ss ..^ $ss + $days-in-month &#123;</div><div class="line">            @slots[$_] = $dt.day.fmt(&quot;%2d&quot;);</div><div class="line">            $dt++</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        my $weekdays = @days.fmt(&quot;%2s&quot;).join: &quot; &quot;;</div><div class="line">        say center(@months[$month-1] ~ &quot; &quot; ~ $year, $weekdays.chars);</div><div class="line">        say $weekdays;</div><div class="line">        for @slots.kv -&gt; $k, $v &#123;</div><div class="line">            print &quot;$v &quot;;</div><div class="line">            print &quot;\n&quot; if ($k+1) %% 7 or $v == $days-in-month;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">     # April 2014</div><div class="line"># Su Mo Tu We Th Fr Sa</div><div class="line">       # 1  2  3  4  5</div><div class="line"> # 6  7  8  9 10 11 12</div><div class="line"># 13 14 15 16 17 18 19</div><div class="line"># 20 21 22 23 24 25 26</div><div class="line"># 27 28 29 30</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">﻿# Perl 6 supports writing a MAIN subroutine that is invoked at startup.</div><div class="line"># Automatically maps arguments to parameters and generates usage instructions.</div><div class="line"></div><div class="line"></div><div class="line">sub MAIN($number, Bool :$upto) &#123;</div><div class="line">    my @fib = 1, 1, *+* ... Inf;</div><div class="line">    if $upto &#123;</div><div class="line">    say join &apos;,&apos;, @fib[0 ..^ $number];</div><div class="line">    &#125;</div><div class="line">    else &#123;</div><div class="line">        say @fib[$number - 1];</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">#`(</div><div class="line">&gt; perl6 MAIN.p6 10</div><div class="line">55</div><div class="line"></div><div class="line">&gt; perl6 MAIN.p6 10 --upto</div><div class="line">Usage:</div><div class="line">  MAIN.p6 [--upto] &lt;number&gt;</div><div class="line"></div><div class="line"># 可选参数写在必选参数前面</div><div class="line">&gt; perl6 MAIN.p6 --upto 10</div><div class="line">1,1,2,3,5,8,13,21,34,55</div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">sub MAIN($file1, $file2) &#123;</div><div class="line">    my $words1 = bag slurp($file1).comb(/\w+/).map(*.lc);</div><div class="line">    my $words2 = set slurp($file2).comb(/\w+/).map(*.lc);</div><div class="line">    my $unique = ($words1 (-) $words2);</div><div class="line">    for $unique.list.sort(&#123; -$words1&#123;$_&#125; &#125;)[^10] -&gt; $word &#123;</div><div class="line">        say &quot;$word: &#123; $words1&#123;$word&#125; &#125;&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Types"><a href="#Types" class="headerlink" title="Types"></a>Types</h2><hr>
<h2 id="Sort"><a href="#Sort" class="headerlink" title="Sort"></a>Sort</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my %hash = &apos;Perl&apos;=&gt;80,</div><div class="line">         &apos;Python&apos;=&gt;100,</div><div class="line">             &apos;Go&apos;=&gt;95,</div><div class="line">            &apos;CMD&apos;=&gt;20,</div><div class="line">            &quot;Php&quot;=&gt;80,</div><div class="line">           &quot;Java&quot;=&gt;85;</div><div class="line"></div><div class="line">for %hash.sort(&#123;-.value&#125;).hash.keys -&gt; $key &#123;</div><div class="line">    say $key, &quot;\t&quot;, %hash&#123;&quot;$key&quot;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my %grade = &quot;example.txt&quot;.IO.lines.map: &#123;</div><div class="line">    m:s/^(\w+) (&lt;[A..F]&gt;&lt;[+-]&gt;?)$/</div><div class="line">        or die &quot;Can&apos;t parse line &apos;$_&apos;&quot;;</div><div class="line"></div><div class="line">    ~$0 =&gt; ~$1;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say %grade;</div><div class="line"></div><div class="line">say &quot;Zsófia&apos;s grade: %grade&lt;Zsófia&gt;&quot;;</div><div class="line">say &quot;List of students with a failing grade:&quot;;</div><div class="line"></div><div class="line">say &quot; &quot; ~%grade.grep(*.value ge &apos;F&apos;)».key.join(&quot; &quot;);</div><div class="line"></div><div class="line">say &quot;Distribution of grades by letter:&quot;;</div><div class="line">say &quot;  &#123;.key&#125;: &#123;+.value&#125; student&#123;&quot;s&quot; if .value != 1&#125;&quot;</div><div class="line">    for %grade.classify(*.value.comb[0]).sort(*.key);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># Sort an array of composite structures by a key. For example, if you define a composite structure that presents a name-value pair (in pseudocode):</div><div class="line"># Define structure pair such that:</div><div class="line">   # name as a string</div><div class="line">   # value as a string</div><div class="line"></div><div class="line"></div><div class="line"># and an array of such pairs:</div><div class="line"># x: array of pairs</div><div class="line"></div><div class="line"></div><div class="line"># then define a sort routine that sorts the array x by the key name.</div><div class="line"></div><div class="line"># This task can always be accomplished with Sorting Using a Custom Comparator. If your language is not listed here, please see the other article.</div><div class="line"></div><div class="line"># Works with: Rakudo Star version 2010.08</div><div class="line"></div><div class="line">my class Employee &#123;</div><div class="line">   has Str $.name;</div><div class="line">   has Rat $.wage;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $boss     = Employee.new( name =&gt; &quot;Frank Myers&quot;     , wage =&gt; 6755.85 );</div><div class="line">my $driver   = Employee.new( name =&gt; &quot;Aaron Fast&quot;      , wage =&gt; 2530.40 );</div><div class="line">my $worker   = Employee.new( name =&gt; &quot;John Dude&quot;       , wage =&gt; 2200.00 );</div><div class="line">my $salesman = Employee.new( name =&gt; &quot;Frank Mileeater&quot; , wage =&gt; 4590.12 );</div><div class="line"></div><div class="line">my @team = $boss, $driver, $worker, $salesman;</div><div class="line"></div><div class="line">my @orderedByName = @team.sort( *.name )&gt;&gt;.name;</div><div class="line">my @orderedByWage = @team.sort( *.wage )&gt;&gt;.name;</div><div class="line"></div><div class="line">say &quot;Team ordered by name (ascending order):&quot;;</div><div class="line">say @orderedByName.join(&apos;  &apos;);</div><div class="line">say &quot;Team ordered by wage (ascending order):&quot;;</div><div class="line">say @orderedByWage.join(&apos;  &apos;);</div><div class="line"></div><div class="line"># this produces the following output:</div><div class="line"># Team ordered by name (ascending order):</div><div class="line"># Aaron Fast   Frank Mileeater   Frank Myers   John Dude</div><div class="line"># Team ordered by wage (ascending order):</div><div class="line"># John Dude   Aaron Fast   Frank Mileeater   Frank Myers</div><div class="line"></div><div class="line"></div><div class="line"># Note that when the sort receives a unary function, it automatically generates an appropriate comparison function based on the type of the data.</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">class Student &#123;</div><div class="line">    has Str $.name;</div><div class="line">    has Int $.grade is rw;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $stu1 = Student.new(name =&gt; &quot;zhangwuji&quot;, grade =&gt; 124);</div><div class="line">my $stu2 = Student.new(name =&gt; &quot;yangguo&quot;,   grade =&gt; 128);</div><div class="line">my $stu3 = Student.new(name =&gt; &quot;zhaomin&quot;,   grade =&gt; 145);</div><div class="line">my $stu4 = Student.new(name =&gt; &quot;sunyizhe&quot;,  grade =&gt; 145);</div><div class="line">my $stu5 = Student.new(name =&gt; &quot;zhouziruo&quot;, grade =&gt; 128);</div><div class="line">my $stu6 = Student.new(name =&gt; &quot;qiaofeng&quot;,  grade =&gt; 124);</div><div class="line"></div><div class="line">my @students = $stu1, $stu2,$stu3,$stu4,$stu5,$stu6;</div><div class="line"></div><div class="line"># classify</div><div class="line"># classify 返回一个散列</div><div class="line">for @students.classify( *.grade ).sort -&gt; $group &#123;</div><div class="line">    say &quot;These students got grade $group.key():&quot;;</div><div class="line">    say .name for $group.value.list;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"># sort</div><div class="line">my @c = @students.sort: -&gt; $a, $b &#123;$a.grade &lt;=&gt; $b.grade&#125;;</div><div class="line">say @c.perl;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my $file = open &apos;scores&apos;;</div><div class="line">my @names = $file.get.words;</div><div class="line"></div><div class="line">my %matches;</div><div class="line">my %sets;</div><div class="line"></div><div class="line">for $file.lines -&gt; $line &#123;</div><div class="line">    my ($pairing, $result) = $line.split(&apos; | &apos;);</div><div class="line">    my ($p1, $p2) = $pairing.words;</div><div class="line">    my ($r1, $r2) = $result.split(&apos;:&apos;);</div><div class="line"></div><div class="line">   %sets&#123;$p1&#125; += $r1;</div><div class="line">   %sets&#123;$p2&#125; += $r2;</div><div class="line"></div><div class="line">   if $r1 &gt; $r2 &#123;</div><div class="line">       %matches&#123;$p1&#125;++;</div><div class="line">   &#125; else &#123;</div><div class="line">       %matches&#123;$p2&#125;++;</div><div class="line">   &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @sorted = @names.sort(&#123; %sets&#123;$_&#125; &#125;).sort(&#123; %matches&#123;$_&#125; &#125;).reverse;</div><div class="line"></div><div class="line">for @sorted -&gt; $n &#123;</div><div class="line">say &quot;$n has won %matches&#123;$n&#125; matches and %sets&#123;$n&#125; sets&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Subset"><a href="#Subset" class="headerlink" title="Subset"></a>Subset</h2><hr>
<ul>
<li>限制字符串长度</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">subset NonEmptyString</div><div class="line">    of Str</div><div class="line">    where *.chars &gt; 0; # 可以把约束条件写到多行</div><div class="line"></div><div class="line">sub firstName(NonEmptyString $name) &#123;</div><div class="line">    say &quot;your name is $name&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">firstName(&apos;Larry&apos;);</div><div class="line">firstName(&apos;&apos;);</div></pre></td></tr></table></figure>
<p>输出：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">your name is Larry</div><div class="line">Constraint type check failed for parameter &apos;$name&apos;</div><div class="line">  in sub firstName at subset.p6:5</div><div class="line">  in block &lt;unit&gt; at subset.p6:10</div></pre></td></tr></table></figure>
<ul>
<li>限制值域</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">subset PointLimit of Int where -10 &lt;= * &lt;= 10;</div><div class="line">sub test(PointLimit $number) &#123;</div><div class="line">    say $number;</div><div class="line">&#125;</div><div class="line">test(-5); # -5</div><div class="line"></div><div class="line">subset SmallInt of Int where -10 .. 10;</div><div class="line">sub small(SmallInt $number) &#123;</div><div class="line">    say $number;</div><div class="line">&#125;</div><div class="line">small(8);</div></pre></td></tr></table></figure>
<ul>
<li>检测密码是否合法</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"># 安全的密码</div><div class="line"># 至少 8 位</div><div class="line"># 包含大写字母、小写字母</div><div class="line"># subset 不能使用 set(*.comb)  形式？</div><div class="line"></div><div class="line">subset Password of Str where *.chars &gt;=8 &amp;&amp; any(&apos;A&apos;..&apos;Z&apos;,&apos;a&apos;..&apos;z&apos;) ∈ *.comb.Set;</div><div class="line"></div><div class="line">sub passwordCheck(Password $password) &#123;</div><div class="line">    say &quot;Password is Valid&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">passwordCheck(&quot;abcdABCD&quot;);</div></pre></td></tr></table></figure>
<ul>
<li>检测密码是否有效并提醒</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">subset Length8    of Str where *.chars &lt; 8;</div><div class="line">subset UpCase     of Str where none(&apos;A&apos;..&apos;Z&apos;) ∈ *.comb.Set;</div><div class="line">subset LowerCase  of Str where none(&apos;a&apos;..&apos;z&apos;) ∈ *.comb.Set;</div><div class="line">subset IntNumber  of Str where none(&apos;0&apos;..&apos;9&apos;) ∈ *.comb.Set;</div><div class="line"></div><div class="line">my $guess = prompt(&apos;Enter your password:&apos;);</div><div class="line"></div><div class="line">given $guess &#123;</div><div class="line">    when Length8   &#123; say &apos;密码长度必须为 8 位 以上&apos;; proceed &#125;</div><div class="line">    when  UpCase   &#123; say &apos;密码必须包括大写字母&apos;;     proceed &#125;</div><div class="line">    when LowerCase &#123; say &apos;密码必须包含小写字母&apos;;     proceed &#125;</div><div class="line">    when IntNumber &#123; say &apos;密码必须包含数字&apos;;                 &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>该程序具有可扩展性， 要增加一种密码验证， 只有添加一个 subset 就好了，然后在 given/when 里面增加一个处理。<br>proceed 相当于 continue， 不像 C 里面的 falling through， Perl 6 里面的 proceed 在继续执行 when 语句时会计算 when 后面的条件</p>
<p>when 可以作为语句修饰符单独使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doit() when 42</div></pre></td></tr></table></figure>
<p>等价于</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">doit() when $_ ~~ 42</div></pre></td></tr></table></figure>
<p>这在列表解析里面很有用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my @lucky = ($_ when /7/ for 1..100);</div><div class="line">7 17 27 37 47 57 67 70 71 72 73 74 75 76 77 78 79 87 97</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">subset NonEmptyString</div><div class="line">    of Str</div><div class="line">    where *.chars &gt; 0;</div><div class="line"></div><div class="line">sub firstName(NonEmptyString $name) &#123;</div><div class="line">    say &quot;your name is $name&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">firstName(&apos;Larry&apos;);</div><div class="line">firstName(&apos;&apos;);</div></pre></td></tr></table></figure>
<h2 id="Traits"><a href="#Traits" class="headerlink" title="Traits"></a>Traits</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">sub add (Int $inputA, Int $inputB --&gt; Int)</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    say $result;         # Oops, this is the last statement, so its return value is used for the subroutine</div><div class="line">&#125;</div><div class="line"></div><div class="line"># my $sum = add(5,6);</div><div class="line"># Type check failed for return value; expected &apos;Int&apos; but got &apos;Bool&apos;</div><div class="line"></div><div class="line">sub add2 (Int $inputA, Int $inputB --&gt; Int)</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    return $result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sum2 = add2(5,6);</div><div class="line">say $sum2;</div><div class="line"></div><div class="line">sub add3 (Int $inputA, Int $inputB) returns Int</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    return $result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sum3 = add3(5,6);</div><div class="line">say $sum3;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">sub fib(Int $nth where * &gt;= 0) &#123;</div><div class="line">  given $nth &#123;</div><div class="line">    when 0 &#123; 0 &#125;</div><div class="line">    when 1 &#123; 1 &#125;</div><div class="line">    default &#123; fib($nth-1) + fib($nth-2) &#125;</div><div class="line"> &#125;</div><div class="line">&#125;</div><div class="line">say fib(3);</div><div class="line">#say fib(-3);</div><div class="line"></div><div class="line">subset FirstName</div><div class="line">    of Str</div><div class="line">  where 0 &lt; *.chars &amp;&amp; *.chars &lt; 256;</div><div class="line"></div><div class="line">sub first_name(FirstName $name)&#123;</div><div class="line">    say &quot;$name&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">first_name(&quot;Wall&quot;);</div><div class="line"></div><div class="line">subset PointLimit of Int where -10 &lt;= * &lt;= 10;</div><div class="line">sub test(PointLimit $number) &#123;</div><div class="line">    say $number;</div><div class="line">&#125;</div><div class="line">test(-5);</div><div class="line"></div><div class="line">subset SmallInt of Int where -10 .. 10;</div><div class="line">sub small(SmallInt $number) &#123;</div><div class="line">    say $number;</div><div class="line">&#125;</div><div class="line"></div><div class="line">small(8);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">multi sub trait_mod:&lt;is&gt;(Routine $r, :$doubles!) &#123;</div><div class="line">    $r.wrap(&#123;</div><div class="line">        2 * callsame;</div><div class="line">    &#125;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub square($x) is doubles &#123;</div><div class="line">    $x * $x;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say square 3;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">my @list of Int = 1..10000;</div><div class="line">say @list[99].WHAT;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">sub divide(Int $a,</div><div class="line">           Int $b where &#123; $^n != 0 &#125;) &#123;</div><div class="line">    return $a / $b;</div><div class="line">&#125;</div><div class="line">say divide(120, 3); # 42</div><div class="line"># say divide(100, 0); # Type check failure</div><div class="line"></div><div class="line"># Here is an example of using subtypes to distinguish between two candidates</div><div class="line"></div><div class="line">multi say_short(Str $x) &#123;</div><div class="line">    say $x;</div><div class="line">&#125;</div><div class="line">multi say_short(Str $x</div><div class="line">                  where &#123; $_.chars &gt;= 12 &#125;) &#123;</div><div class="line">   say substr($x, 0, 10) ~ &apos;...&apos;;</div><div class="line">&#125;</div><div class="line">say_short(&quot;Beer!&quot;);         # Beer!</div><div class="line">say_short(&quot;BeerBeerBeer!&quot;); # BeerBeerBe...</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"># Typed Parameters Can restrict a parameter to only accept arguments of a certain type.</div><div class="line">sub show_dist(Str $from, Str $to, Int $kms) &#123;</div><div class="line">    say &quot;From $from to $to is $kms km.&quot;;</div><div class="line">&#125;</div><div class="line">show_dist(&apos;Copenhagen&apos;, &apos;Beijing&apos;, 7305);</div><div class="line">show_dist(7305, &apos;Copenhagen&apos;, &apos;Beijing&apos;);</div></pre></td></tr></table></figure>
<h2 id="Twigils"><a href="#Twigils" class="headerlink" title="Twigils"></a>Twigils</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"> class Point &#123;</div><div class="line">        has $.x;</div><div class="line">        has $.y;</div><div class="line"></div><div class="line">        method Str() &#123;</div><div class="line">           return ($.x, $.y); # 注意我们这次使用 . 而不是 !</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">my $p = Point.new(x=&gt;10,y=&gt;20);</div><div class="line">my ($height,$wide) = $p.Str();</div><div class="line">say &quot;高度:$height&quot;;</div><div class="line">say &quot;宽度:$wide&quot;;</div><div class="line"></div><div class="line"></div><div class="line"> class SaySomething &#123;</div><div class="line">        method a() &#123; say &quot;a&quot;; &#125;</div><div class="line">        method b() &#123; say $.a; &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    SaySomething.a; # prints &quot;a&quot;</div><div class="line">    SaySomething.b;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">my @fave_foods = &lt;hanbao pingguo TV&gt;;</div><div class="line">for @fave_foods -&gt; $food &#123;</div><div class="line">    say &quot;Jonathan likes to eat $food&quot;;</div><div class="line">&#125;</div><div class="line"># The bit between the curly braces is done for each thing in the array</div><div class="line"># -&gt; $name means “declare $name and put the current thing into it”</div><div class="line"></div><div class="line"># $^identifier 变量用于块中:</div><div class="line"></div><div class="line">my @str = &lt;a very long but shorthand really&gt;;</div><div class="line">my @sorted = sort &#123; $^a.chars &lt;=&gt; $^b.chars&#125;, @str;</div><div class="line">say @sorted;</div><div class="line"></div><div class="line"># sort 可以更简洁</div><div class="line">my @s = sort &#123; .chars &#125;, @str;</div><div class="line">say @s;</div><div class="line"></div><div class="line">my $block = &#123;</div><div class="line">    $^a + $^b;</div><div class="line">&#125;;</div><div class="line">say $block(1,99);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"># Twigils影响变量的作用域。请记住, twigils 对基本的魔符插值没有影响，那就是:</div><div class="line"># 如果  $a 内插， $^a, $*a, $=a, $?a, $.a, 等等也会内插. 它仅仅取决于 $.</div><div class="line"></div><div class="line">    my $lexical   = 1;</div><div class="line">    my $*dynamic1 = 10;</div><div class="line">    my $*dynamic2 = 100;</div><div class="line"></div><div class="line">    sub say-all() &#123;</div><div class="line">        say &quot;$lexical, $*dynamic1, $*dynamic2&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    # prints 1, 10, 100</div><div class="line">    say-all();</div><div class="line"></div><div class="line">    &#123;</div><div class="line">        my $lexical   = 2;</div><div class="line">        my $*dynamic1 = 11;</div><div class="line">        $*dynamic2    = 101;</div><div class="line"></div><div class="line">        # prints 1, 11, 101 ,why 2, 11 ,101?</div><div class="line">        # $lexical isn&apos;t looked up in the caller&apos;s scope but in the scope &amp;say-all was defined in.</div><div class="line">        # The two dynamic variables are looked up in the callers scope and therefore have the values 11 and 101.</div><div class="line">        # 翻译过来就是, $lexical 不是在调用者的作用域内被查找, 而是在 &amp;say-all 被定义的作用域那儿</div><div class="line">        # 也就是第一行的 $lexical = 1 了. 另外两个动态作用域变量在调用者的作用域内被查找, 所以值为 11 和 101</div><div class="line">        say-all();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    # prints 1, 10, 101</div><div class="line">    say-all();</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># ? twigil 编译常量</div><div class="line">say &quot;$?FILE: $?LINE&quot;; # wenhao.p6: 4</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># ^ twigil 为block 块 或 子例程 申明了一个形式位置参数.</div><div class="line"># 形如 $^variable 的变量是一种占位变量. 它们可用在裸代码块中来申明代码块的形式参数. 看下面代码中的块:</div><div class="line"></div><div class="line">for ^4 &#123;</div><div class="line">    say &quot;$^seconds follows $^first&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 1 follows 0</div><div class="line"># 3 follows 2</div></pre></td></tr></table></figure>
<h2 id="Whatever"><a href="#Whatever" class="headerlink" title="Whatever"></a>Whatever</h2><hr>
<p> 当作为一个项使用时， 我们把 <em> 叫做 “whatever”<br> 当不是实际值时，它用作占位符<br> 例如, 1, 2, 3 … </em><br> 意思是没有终结点的自然数序列</p>
<p> Whatever 闭包<br> Whatever 最强大的用处是 Whatever 闭包</p>
<p> 对于 whatever 没有特殊意义的普通操作符：<br>     把 whatever 当作参数传递时就创建了一个闭包！<br> 所以，举个例子，  <code>* + 1</code> 等价于 <code>-&gt; $a { $a + 1 }</code><br> <code>* + *</code> 等价于 <code>-&gt; $a, $b { $a + $b }</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">@list.grep(* &gt; 10) # 返回 @list 数组中所有大于 10 的元素</div><div class="line">@list.map(* + *)   # 返回 @list 中每对儿的和</div></pre></td></tr></table></figure>
<p>如果给 @a[ ] 的方括号里面传递一个闭包， 它会把 @a 数组的元素个数作为参数传递并计算！</p>
<ul>
<li>数组的最后一个元素</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">my @a =  1,22,33,11;</div><div class="line">say @a[*-1];</div><div class="line">say @a[-&gt;$a &#123;$a-1&#125;]; # $a  即为数组@a 的元素个数</div></pre></td></tr></table></figure>
<ul>
<li>数组的倒数第二个元素</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">say @a[*-2];</div><div class="line">say @a[-&gt;$a &#123;$a-2&#125;];</div></pre></td></tr></table></figure>
<p>所以 <code>@a[*/2]</code> 是 @a 数组的中间元素<br><code>@a[1..*-2]</code>  是@a 中不包含首尾元素的其它元素<br><code>1, 1, * + * ... *</code>  是一个无限列表</p>
<ul>
<li><ul>
<li><ul>
<li>是后来值的生成规则， 最后一个 * 表示没有终结测试。</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"># 把闭包存储在标量中</div><div class="line">my $a = -&gt; $b &#123; $b + 1 &#125;</div><div class="line">$a(3) # 4</div></pre></td></tr></table></figure>
<p>Perl 6 的列表求值是惰性的<br>只要你不要求最后一个元素， 无限列表是没问题的。<br>使用绑定 (:=) 操作符把列表赋值给变量：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">my @fib := 1, 1, * + * ... *</div></pre></td></tr></table></figure>
<p>如果我稍后要 @fib[40] 的值， 会生成足够多的元素以获取数组的第 41 个元素<br>那些生成的元素会被记忆。<br>尽管未来， 如果列表未绑定给变量， 之前的值会被忘记<br>大部分 Perl 6 列表函数能作用并生成惰性列表<br>@a.map 和 @a.grep 都生成惰性列表， 即使 @a 不是惰性的。<br>@fib.grep(* %% 2) 是一个偶数惰性列表，例如<br>@fib Z @a 生成一个惰性列表： @fib[0], @a[0], @fib[1], @a[1] …<br>给 for 循环传递一个无限列表是没问题的， 它会循环直到停止。</p>
<h2 id="When"><a href="#When" class="headerlink" title="When"></a>When</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># given 和 when：</div><div class="line"># given 接收一个参数和一个 block</div><div class="line"># given 把它接收的参数设置为 $_, 然后调用后面的 block</div><div class="line"># when 也接收一个参数和一个 block</div><div class="line"># when 将 $_ 和 when 接收的参数进行智能匹配</div><div class="line"># 如果结果是 True， 则执行代码块</div><div class="line"># 然后控制就跳出 when 的包围圈</div><div class="line"></div><div class="line">my $ticks = 0;</div><div class="line">given $ticks &#123;</div><div class="line">    when 1   &#123;say &quot;&quot;;      &#125;</div><div class="line">    when 1/2 &#123;say &quot;/&quot;;     &#125;</div><div class="line">    when Int &#123;say $_.Str;  &#125;</div><div class="line">    when Rat &#123;say $_.perl; &#125;</div><div class="line">    die &quot;Duration must be Int or Rat, but it&apos;s &#123; $_.WHAT &#125;&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># given 和 when 可以单独使用</div><div class="line"># 设置了 $_,  进行一系列操作时，given 比较方便</div><div class="line"># 当 $_ 被设置后 ， when 可以用在任何地方</div><div class="line"># when 在 for 循环中很方便</div><div class="line"></div><div class="line">my $boring-lines = 0;</div><div class="line">for $*IN.lines &#123;</div><div class="line">    when /&quot;Lunasa&quot; | &quot;Altan&quot;/ &#123; say &quot;Found band!&quot;;       &#125;</div><div class="line">    when /&quot;fiddle&quot; | &quot;flute&quot;/ &#123; say &quot;Found instrument!&quot;; &#125;</div><div class="line">    $boring-lines++;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="Smart-Matching"><a href="#Smart-Matching" class="headerlink" title="Smart-Matching"></a>Smart-Matching</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">constant A = 100;</div><div class="line">constant B = 100;</div><div class="line"></div><div class="line">my (%powers, %count);</div><div class="line"></div><div class="line"># find bases which are powers of a preceeding root base</div><div class="line"># store decomposition into base and exponent relative to root</div><div class="line">for 2..Int(sqrt A) -&gt; \a &#123;</div><div class="line">    next if a ~~ %powers;</div><div class="line">    %powers&#123;a, a**2, a**3 ...^ * &gt; A&#125; = a X=&gt; 1..*;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># count duplicates</div><div class="line">for %powers.values -&gt; \p &#123;</div><div class="line">    for 2..B -&gt; \e &#123;</div><div class="line">        # raise to power \e</div><div class="line">        # classify by root and relative exponent</div><div class="line">        ++%count&#123;p.key =&gt; p.value * e&#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># add +%count as one of the duplicates needs to be kept</div><div class="line">say (A - 1) * (B - 1) + %count - [+] %count.values;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my %lilei     =&apos;Math&apos;=&gt;98,&apos;Chinese&apos;=&gt;&apos;72&apos;,&apos;English&apos;=&gt;&apos;128&apos;;</div><div class="line">my %hanmeimei =&apos;Math&apos;=&gt;98,&apos;Chinese&apos;=&gt;&apos;72&apos;,&apos;English&apos;=&gt;&apos;128&apos;;</div><div class="line">say &quot;they have the same course&quot; if %lilei.keys ~~ %hanmeimei.keys;</div><div class="line">say &apos;true&apos; if %lilei&#123;%hanmeimei.keys&#125; ~~ %hanmeimei.values;</div><div class="line"></div><div class="line">my $a = 2</div><div class="line">say so $a ~~ 1..3</div><div class="line">say so $a ~~ Int</div><div class="line">say so $a ~~ 23</div><div class="line">say so $a ~~ &#123;$_.Str ne $_.perl&#125;</div><div class="line">say so (1..3).ACCEPTS($a)</div></pre></td></tr></table></figure>
<h2 id="Regexes"><a href="#Regexes" class="headerlink" title="Regexes"></a>Regexes</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">print &apos;ok&apos; if &apos;1,2,3&apos; ~~ / \d+ % &apos;,&apos; /; # ok</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"># caps 方法返回所有的捕获，命名的和位置的，按照它们匹配的文本在原始字符串中出现的顺序返回。返回的值是一个 Pair 对象列表。键是捕获的名字或数量，键值是对应的 Match 对象。</div><div class="line"></div><div class="line">if &apos;abc&apos; ~~ m/(.) &lt;alpha&gt; (.) / &#123;</div><div class="line">            say $/.caps.WHAT; # (Parcel)</div><div class="line">            my @a = $/.caps;  </div><div class="line">            say @a;           # 0 =&gt; ｢a｣ alpha =&gt; ｢b｣ 1 =&gt; ｢c｣ ( 0 =&gt; ｢a｣ 是一个 Pair 对象</div><div class="line">            say &quot; -&gt; 这次匹配有  @a.elems() 个 Pair&quot;;</div><div class="line">               for $/.caps &#123;</div><div class="line">                    say .key, &apos; =&gt; &apos;, .value.Str; # 键值是 对应的Match 对象, 需要调用 Str 方法, 得到字符串.</div><div class="line"></div><div class="line">             &#125;</div><div class="line"> &#125;</div><div class="line"></div><div class="line"> # Output:</div><div class="line"> #          0 =&gt; a</div><div class="line"> #      alpha =&gt; b</div><div class="line"> #          1 =&gt; c</div><div class="line"></div><div class="line"></div><div class="line">#  复习下 Parcel</div><div class="line"># Parcel 由 () &lt;&gt;  逗号分割的列表, 或其它引用结构</div><div class="line"># ()</div><div class="line"># 1,2,3</div><div class="line"># &lt;a b c&gt;</div><div class="line"># &lt;&lt;a b c&gt;&gt;</div><div class="line"># qw/a b c/</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">my $s = &apos;the quick brown fox jumped over the the lazy dog&apos;;</div><div class="line">if $s ~~ m/ &lt;&lt; (\w+) \W+ $0 &gt;&gt; / &#123; # if 不再需要圆括号</div><div class="line">    say &quot;Found &apos;$0&apos; twice in a row&quot;;</div><div class="line">    say &quot;Found &apos;$/[0]&apos; twice in a line&quot; # $/[0]  可以简写为 $0</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"> my $ingredients = &apos;milk, flour, eggs and sugar&apos;;</div><div class="line"> # prints &quot;milk, flour, eggs&quot;, 如果 say $/[0] 只会打印 || , 因为[] 是非捕获组!</div><div class="line"> $ingredients ~~ m/ [\w+]+ % [\,\s*] / &amp;&amp; say &quot;|$/|&quot;;</div><div class="line"># |milk, flour, eggs|</div><div class="line"># 这里 \w+ 匹配一个单词，并且 [\w+]+ % [\,\s*]  匹配至少一个单词，并且单词之间用逗号和任意数量的空白分隔。</div><div class="line"> &apos;1,2,3&apos; ~~ / \d+ % &apos;,&apos; / &amp;&amp; say &quot;|$/|&quot;;</div><div class="line"># |1,2,3|</div><div class="line"># %必须要跟在量词后面，否则报错。</div><div class="line"># 在 [\w+] 里面 [ ] 是非捕获组</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"># 如果你在捕获后面加上量词，匹配对象中的对应的项是一列其它对象：</div><div class="line"></div><div class="line">use v6;</div><div class="line">my $ingredients = &apos;eggs, milk, sugar and flour&apos;;</div><div class="line"></div><div class="line">if $ingredients ~~ m/(\w+)+ % [\,\s*] \s* &apos;and&apos; \s* (\w+)/ &#123;</div><div class="line">    say &apos;list: &apos;, $/[0].join(&apos; | &apos;);</div><div class="line">    say &apos;end: &apos;, &quot;$/[1]&quot;;</div><div class="line">    say $/.elems; # 数组 $/ 中含有 2 个元素</div><div class="line">    say $/[0].WHAT;  # ARRAY, 第一个捕获 $/[0] 其实是一个数组</div><div class="line">    say $/[0].elems; # 3, 第一个 (\w+) 匹配了 3 次</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 这打印:</div><div class="line"># list: eggs | milk | sugar</div><div class="line"># end: flour</div><div class="line"></div><div class="line">#  第一个捕获(\w+)被量词化了，所以$/[0]包含一列单词。代码调用 .join方法将它转换为字符串。</div><div class="line">#  不管第一个捕获匹配了多少次（并且有$/[0]中有多少元素），第二个捕获$/[1]始终可以访问。</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my $str = &apos;Germany was reunited on 1990-10-03, peacefully&apos;;</div><div class="line"></div><div class="line">if $str ~~ m/ (\d**4) \- (\d\d) \- (\d\d) / &#123;</div><div class="line">    say $/.WHAT;  # Match</div><div class="line">    say $/.elems; # 3</div><div class="line">    say &apos;Year: &apos;,&quot;$/[0]&quot;;</div><div class="line">    say &apos;Month: &apos;,&quot;$/[1]&quot;;</div><div class="line">    say &apos;Day: &apos;,&quot;$/[2]&quot;;</div><div class="line"></div><div class="line">    # usage as an array:</div><div class="line">    say $/.join(&apos;-&apos;); # prints 1990-10-03</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Year: 1990</div><div class="line"># Month: 10</div><div class="line"># Day: 03</div><div class="line"># 1990-10-03</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">my $s = &apos;the quick brown fox jumped over the the lazy dog&apos;;</div><div class="line">my regex word &#123; \w+ [ \&apos; \w+ ]?              &#125;</div><div class="line">my regex dup  &#123; « &lt;danci=&amp;word&gt; \W+ $&lt;danci&gt; » &#125; # 要使用 &amp;name 调用正则, 就像调用子例程一样 &amp;sub , 调用后的结果起名为 danci, 就像给子例程起名字一样</div><div class="line">if $s ~~ m/ &lt;dupword=&amp;dup&gt; / &#123;</div><div class="line">    say &quot;Found &apos;&#123;$&lt;dupword&gt;&lt;danci&gt;&#125;&apos; twice in a row&quot;;</div><div class="line">    # say $/.keys(); # dupword, 获取散列的键</div><div class="line">    say $/;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 这段代码引入了一个名为 word 的正则表达式，它至少匹配一个单词字符，后面跟着一个可选的单引号和更多的单词字符。</div><div class="line"># 另外一个名为 dup （duplcate的缩写，副本的意思）的正则包含一个单词边界锚点。</div><div class="line"></div><div class="line"># 在正则里面，语法 &lt;&amp;word&gt; 在当前词法作用域内查找名为word的正则并匹配这个正则表达式。</div><div class="line"># &lt;name=&amp;regex&gt; 语法创建了一个叫做 name 的捕获，它记录了 &amp;regex 匹配的内容。</div><div class="line"></div><div class="line"># 在这个例子中，dup 调用了名为 word 正则，随后匹配至少一个非单词字符，之后再匹配相同的字符串（ 前面word 正则匹配过的）一次，它以另外一个字符边界结束。这种向后引用的语法记为美元符号 $  后面跟着用尖括号包裹着捕获的名字。</div><div class="line"></div><div class="line"># 在 if 代码块里， $&lt;dupword&gt; 是  $/&#123;&apos;dupword&apos;&#125; 的快捷写法。因为 $/ 是一个特殊的散列, 所以可以通过键 &#123;&apos;dupword&apos;&#125; 访问到散列的值. 它访问正则 dup 产生的匹配对象。</div><div class="line"># dup 也有一个叫 danci 的子规则。从那个调用产生的匹配对象用 $&lt;dupword&gt;&lt;danci&gt;来访问。</div><div class="line"></div><div class="line"># 直接打印 $/ 的结果, $/ 这里又变成了一个特殊的散列, fuck, 上次它不是一个特殊的数组吗? 百变星君啊,擦!</div><div class="line">#</div><div class="line"></div><div class="line"># ｢the the｣</div><div class="line">#  dupword =&gt; ｢the the｣</div><div class="line">#   danci =&gt; ｢the｣</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my $ingredients = &apos;eggs, milk, sugar and flour&apos;;</div><div class="line"></div><div class="line">if $ingredients ~~ m/(\w+)+ % [\,\s*] \s* &apos;and&apos; \s* (\w+)/ &#123;</div><div class="line">say &apos;list: &apos;, $/[0].join(&apos; | &apos;);</div><div class="line">say &apos;end: &apos;, &quot;$1&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my $str = &apos;Germany was reunited on 1990-10-03, peacefully&apos;;</div><div class="line"></div><div class="line">if $str ~~ m/ (\d**4) \- (\d\d) \- (\d\d) / &#123;</div><div class="line">say &apos;Year: &apos;,&quot;$/[0]&quot;;</div><div class="line">say &apos;Month: &apos;,&quot;$/[1]&quot;;</div><div class="line">say &apos;Day: &apos;,&quot;$/[2]&quot;;</div><div class="line"># usage as an array:</div><div class="line">say $/.join(&apos;-&apos;); # prints 1990-10-03</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">my regex insigline &#123;</div><div class="line">^ \s* [ &lt;?&gt; | &apos;#&apos; .* | &apos;&#123;&apos; | &apos;&#125;&apos; ] \s* $</div><div class="line">&#125;</div><div class="line">  sub MAIN(*@files) &#123;</div><div class="line">      my $total = 0;</div><div class="line">      for @files -&gt; $filename &#123;</div><div class="line">           try &#123;</div><div class="line">           $total += lines($filename.IO).grep(</div><div class="line">              &#123; $_ !~~ /&lt;&amp;insigline&gt;/ &#125; ).elems;</div><div class="line">      &#125;</div><div class="line">     note &quot;can&apos;t read $filename &quot; if $!;</div><div class="line">   &#125;</div><div class="line">say $total;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"> my $ingredients = &apos;eggs, milk, sugar and flour&apos;;</div><div class="line"></div><div class="line"> if $ingredients ~~ m/:s ( \w+ )+ % \,&apos;and&apos; (\w+)/ &#123;</div><div class="line"> say &apos;list: &apos;, $/[0].join(&apos; | &apos;);</div><div class="line"> say &apos;end: &apos;, &quot;$/[1]&quot;;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h2 id="Subroutine"><a href="#Subroutine" class="headerlink" title="Subroutine"></a>Subroutine</h2><hr>
<p><code>--&gt;</code> 在 Perl 6 中是什么意思？<br><code>--&gt;</code> 就是指定返回值的类型</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">sub add (Int $inputA, Int $inputB --&gt; Int)</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    say $result; # this is the last statement, so its return value is used for the subroutine</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sum = add(5,6);</div><div class="line"># Type check failed for return value; expected &apos;Int&apos; but got &apos;Bool&apos;</div><div class="line"></div><div class="line"></div><div class="line">sub add2 (Int $inputA, Int $inputB --&gt; Int)</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    return $result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sum2 = add2(5,6);</div><div class="line">say $sum2;</div></pre></td></tr></table></figure>
<p>使用  <code>return</code> 约束更清晰：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sub add3 (Int $inputA, Int $inputB) returns Int</div><div class="line">&#123;</div><div class="line">    my $result = $inputA+$inputB;</div><div class="line"></div><div class="line">    return $result;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sum3 = add3(5,6);</div><div class="line">say $sum3;</div></pre></td></tr></table></figure>
<h2 id="Signatures"><a href="#Signatures" class="headerlink" title="Signatures"></a>Signatures</h2><hr>
<p>签名的几种形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sub optional               &#123;...&#125;</div><div class="line">sub basic($foo)            &#123;...&#125;</div><div class="line">sub default($foo = 3)      &#123;...&#125;</div><div class="line">sub named(:$name)          &#123;...&#125;</div><div class="line">sub typed(Bool $is_foo)    &#123;...&#125;</div><div class="line">sub constraint(Str $name</div><div class="line">    where *.chars &gt; 0)     &#123;...&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line">my @a=1,2,3;</div><div class="line">my $s=&apos;Escape Plan&apos;;</div><div class="line">my %h=&apos;Rakudo&apos;=&gt;&apos;Star&apos;,&apos;STD&apos;=&gt;&apos;Larry&apos;;</div><div class="line"></div><div class="line"># 捕获就是一系列实参的签名</div><div class="line">my $capture = \(@a,$s,%h);      # creating a capture, &quot;\&quot; was free since there are no references anymore</div><div class="line">say(|$capture).perl;            # flatten into argument list (hash like context)</div><div class="line"># ||$cap;                       # flatten into semicolon list (array like context)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># A set of parameters form a signature. 一组形参组成签名</div><div class="line"># A set of arguments form a capture.    一组实参组成捕获</div><div class="line"></div><div class="line">sub greet($name, :$greeting = &apos;Hi&apos;) &#123;</div><div class="line">    say &quot;$greeting, $name!&quot;;</div><div class="line">&#125;</div><div class="line">greet(&apos;Лена&apos;, greeting =&gt; &apos;Привет&apos;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sub rectangle(:$width!, :$height!, :$char = &apos;X&apos;) &#123;</div><div class="line">    say $char x $width for ^$height;</div><div class="line">&#125;</div><div class="line"></div><div class="line">rectangle char =&gt; &apos;o&apos;, width =&gt; 8, height =&gt; 4;</div><div class="line">rectangle :width(20), :height&lt;5&gt;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Sometimes, you need to do some more powerful validation on arguments.</div><div class="line"></div><div class="line">sub discount($price, $percent</div><div class="line">             where (1 &lt;= $percent &lt;= 100)) &#123;</div><div class="line">    say &quot;You get $percent% off! Pay EUR &quot; ~ $price - ($price * $percent / 100);</div><div class="line">&#125;</div><div class="line">discount(100, 20);</div><div class="line">discount(100, 200);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Be careful about using type constraints on arrays and hashes. The type constraints the elements.</div><div class="line"># 在对数组和散列使用类型限制时要小心. 类型限制的是元素!</div><div class="line"></div><div class="line">sub total(Array @distances) &#123; # 限制数组 @distances 中的每个元素为数组.</div><div class="line">    # WRONG! Takes an Array of Arrays!</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub total(Int @distances) &#123;</div><div class="line">    # Correct, takes an array of Ints.</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Dispatch By Arity(he number of arguments that a function can take)</div><div class="line"># Example (from Test.pm): dispatch by different number of parameters</div><div class="line"></div><div class="line">multi sub todo($reason, $count) is export &#123;</div><div class="line">    $todo_upto_test_num = $num_of_tests_run + $count;</div><div class="line">    $todo_reason = &apos;# TODO &apos; ~ $reason;</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub todo($reason) is export &#123;</div><div class="line">    $todo_upto_test_num = $num_of_tests_run + 1;</div><div class="line">    $todo_reason = &apos;# TODO &apos; ~ $reason;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Can use multiple dispatch with constraints to do a lot of &quot;write what you know&quot; style solutions</div><div class="line"></div><div class="line"># Factorial:</div><div class="line"># fact(0) = 1</div><div class="line"># fact(n) = n * fact(n - 1)</div><div class="line"></div><div class="line">multi fact(0)  &#123; 1 &#125;;</div><div class="line">multi fact($n) &#123; $n * fact($n - 1) &#125;;</div><div class="line"></div><div class="line">say fact(10);</div><div class="line"></div><div class="line"></div><div class="line"># Fibonacci Sequence:</div><div class="line"># fib(0) = 0</div><div class="line"># fib(1) = 1</div><div class="line"># fib(n) = fib(n - 1) + fib(n - 2)</div><div class="line"></div><div class="line"># mutil 声明的子例程语句结尾不需要跟分号;</div><div class="line">multi fib(0)  &#123; 0 &#125;</div><div class="line">multi fib(1)  &#123; 1 &#125;</div><div class="line">multi fib($n) &#123; fib($n - 1) + fib($n - 2) &#125;</div><div class="line"></div><div class="line">say fib(10);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Example: part of a JSON emitter</div><div class="line"></div><div class="line">multi to-json(Array $a) &#123;</div><div class="line">    return &apos;[ &apos; ~</div><div class="line">        $a.values.map(&#123; to-json($_) &#125;).join(&apos;, &apos;) ~</div><div class="line">        &apos; ]&apos;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi to-json(Hash $h) &#123;</div><div class="line">    return &apos;&#123; &apos; ~</div><div class="line">        $h.pairs.map(&#123;</div><div class="line">            to-json(.key) ~ &apos;: &apos; ~ to-json(.value)</div><div class="line">        &#125;).join(&apos;, &apos;) ~</div><div class="line">        &apos; &#125;&apos;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sub fst(*@ [$fst])&#123;</div><div class="line">    say $fst;</div><div class="line">&#125;</div><div class="line"></div><div class="line">fst(1);</div><div class="line">fst(1,2);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sub is-in(@array, $elem) &#123;</div><div class="line">  # this will `return` out of the `is-in` sub</div><div class="line">  # once the condition evaluated to True, the loop won&apos;t be run anymore</div><div class="line">  map(&#123; return True if $_ ==  $elem &#125;, @array);</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @array = 1,2,3,4,5;</div><div class="line">is-in(@array,3);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">sub escape ($str) &#123;</div><div class="line">    $_ = $str;</div><div class="line">    # Puts a slash before non-alphanumeric characters</div><div class="line">    s:g[&lt;-alpha-digit&gt;] = &quot;\\$/&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say escape &quot;foobar&quot;;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    sub escape ($str) &#123;</div><div class="line">        $_ = $str;</div><div class="line">        # Writes each non-alphanumeric character in its hexadecimal escape</div><div class="line">        s:g[&lt;-alpha-digit&gt;] = &quot;\\x[&#123; $/.base(16) &#125;]&quot;;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    say escape &quot;foo#bar?&quot;; # foo\x[23]bar\x[3F]</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Back to original escape function</div><div class="line">say escape &quot;foo#bar?&quot;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">sub greet($name, $greeting = &apos;Ahoj&apos;) &#123;</div><div class="line">    say &quot;$greeting, $name!&quot;;</div><div class="line">&#125;</div><div class="line">greet(&apos;Anna&apos;); # Ahoj Anna</div><div class="line">greet(&apos;Лена&apos;, &apos;Привет &apos;); # Привет, Лена&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># In Perl 6, passing an array or hash works like passing a reference</div><div class="line"># 在 Perl 6中, 传递数组或散列就像传递引用那样</div><div class="line"></div><div class="line">sub example(@array, %hash) &#123;</div><div class="line">    say @array.elems;</div><div class="line">    say %hash.keys.join(&apos;, &apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @numbers = 1,2,3,4;</div><div class="line">my %ages = Jnthn =&gt; 25, Noah =&gt; 120;</div><div class="line">example(@numbers, %ages);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># Empty list sorts to the empty list</div><div class="line">multi quicksort([]) &#123; () &#125;</div><div class="line"></div><div class="line"># Otherwise, extract first item as pivot...</div><div class="line">multi quicksort([$pivot, *@rest]) &#123;</div><div class="line"></div><div class="line">    # Partition.</div><div class="line">    my @before = @rest.grep(* &lt; $pivot);</div><div class="line">    my @after  = @rest.grep(* &gt;= $pivot);</div><div class="line">    # Sort the partitions.</div><div class="line">    (quicksort(@before), $pivot, quicksort(@after))</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @unsorted = &lt;13 1 9 12 4 2015&gt;;</div><div class="line">say quicksort(@unsorted); # 1  4  9  12  13  2015</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">sub convert_currency($amount, $rate) &#123;</div><div class="line">    $amount = $amount * $rate;</div><div class="line">    return $amount;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub convert_currency_copy($amount is copy, $rate) &#123;</div><div class="line">    $amount = $amount * $rate;</div><div class="line">    return $amount;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub convert_currency_rw($amount is rw, $rate) &#123;</div><div class="line">    $amount = $amount * $rate;</div><div class="line">    return $amount;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">my $price = 99;</div><div class="line">$price = convert_currency($price, 11.1);</div><div class="line">$price_copy = convert_currency_copy($price, 11.1);</div><div class="line">$price_rw = convert_currency_rw($price, 11.1);</div><div class="line"></div><div class="line">say $price;</div><div class="line">say $price_copy;</div><div class="line">say $price_rw;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># In Perl 6, every value knows its type.</div><div class="line"></div><div class="line">say 42.WHAT;</div><div class="line">say &quot;camel&quot;.WHAT;</div><div class="line">say [1, 2, 3].WHAT;</div><div class="line">say (sub ($n) &#123; $n * 2 &#125;).WHAT;</div><div class="line"></div><div class="line"># (Int)</div><div class="line"># (Str)</div><div class="line"># (Array)</div><div class="line"># (Sub)</div><div class="line"></div><div class="line"># A type name in Perl 6 represents all possible values of that type.</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># Sometimes, you want to accept any type, but then transform it into another type before binding to the parameter</div><div class="line"># 强制类型转换</div><div class="line"></div><div class="line">sub show_dist($from, $to, $kms as Int) &#123;</div><div class="line">   say &quot;From $from to $to is $kms km.&quot;;</div><div class="line">&#125;</div><div class="line">show_dist(&apos;Kiev&apos;, &apos;Lviv&apos;, &apos;469&apos;);</div><div class="line">show_dist(&apos;Kiev&apos;, &apos;Lviv&apos;, 469.35);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># Can restrict a parameter to only accept arguments of a certain type.</div><div class="line"></div><div class="line"></div><div class="line">sub show_dist(Str $from, Str $to, Int $kms) &#123;</div><div class="line">    say &quot;From $from to $to is $kms km.&quot;;</div><div class="line">&#125;</div><div class="line">show_dist(&apos;Kiev&apos;, &apos;Lviv&apos;, 469);</div><div class="line">show_dist(469, &apos;Kiev&apos;, &apos;Lviv&apos;); #  Error!</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sub  foo(@array [$fst, $snd]) &#123;</div><div class="line">  say &quot;My first is $fst, my second is $snd ! All in all, I&apos;m @array[].&quot;;</div><div class="line">  # (^ remember the `[]` to interpolate the array)</div><div class="line">&#125;</div><div class="line">my @tail = 1,2;</div><div class="line">foo(@tail);</div><div class="line"></div><div class="line"> #=&gt; My first is 2, my second is 3 ! All in all, I&apos;m 2 3</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line"># Can extract values by attribute (only those that are declared with accessors)</div><div class="line"></div><div class="line">sub nd($r as Rat (:$numerator, :$denominator)) &#123;</div><div class="line">    say &quot;$r = $numerator/$denominator&quot;;</div><div class="line">&#125;</div><div class="line">nd(4.2);</div><div class="line">nd(3/9);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">sub slurp-in-array(@ [$fst, *@rest]) &#123; # You could keep `*@rest` anonymous</div><div class="line">  say $fst + @rest.elems;   # `.elems` returns a list&apos;s length.</div><div class="line">                            # Here, `@rest` is `(3,)`, since `$fst` holds the `2`.</div><div class="line">&#125;</div><div class="line">my @array = &lt;2 3 4 5&gt;;</div><div class="line">slurp-in-array(@array);</div></pre></td></tr></table></figure>
<h2 id="Built-in-types-and-functions"><a href="#Built-in-types-and-functions" class="headerlink" title="Built-in types and functions"></a>Built-in types and functions</h2><hr>
<h3 id="classify"><a href="#classify" class="headerlink" title=".classify"></a>.classify</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">.say for slurp(&quot;README.txt&quot;)\    # whole file into string</div><div class="line">         .words()\               # split into list of words</div><div class="line">         .classify( *.Str );</div><div class="line"></div><div class="line">my @a = slurp(&quot;README.txt&quot;).words;</div><div class="line">.say  for @a.classify( *.Str );</div><div class="line"></div><div class="line"># 输出的是一个散列</div><div class="line"># that =&gt; that that</div><div class="line"># the  =&gt; the the the the the the the the the</div><div class="line"># is   =&gt; is is is</div><div class="line"># ......</div><div class="line"></div><div class="line">my %hash = @a.classify( *.Str );</div><div class="line"># 输出前 10 个最常见的单词</div><div class="line">for %hash.sort(&#123;-.value.elems&#125;).hash.kv.[^20] -&gt; $key, $value &#123;</div><div class="line">    say $key ,&quot;\t&quot;, $value.elems;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p>分类后，生成一个散列， 键是  分类依据（可以根据字符数，字符等），下面这例是根据字符数分类， 它会把字符数相同的元素归为一类， 键值就是数组里的元素。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">my @names = &lt;Patrick Jonathan Larry Moritz Audrey&gt;;</div><div class="line">say .key, &quot;\t&quot;, ~.values</div><div class="line">     for @names.classify( *.chars );</div><div class="line"></div><div class="line"># Output:</div><div class="line"># 5       Larry</div><div class="line"># 6       Moritz Audrey</div><div class="line"># 7       Patrick</div><div class="line"># 8       Jonathan</div><div class="line"></div><div class="line">.say for slurp(&quot;README&quot;)\             # whole file into string</div><div class="line">    .words()\                         # split into list of words</div><div class="line">    .classify( *.Str )\               # group words w/ multiplicity</div><div class="line">    .map(&#123;; .key =&gt; .value.elems &#125;)\  # turn lists into lengths</div><div class="line">    .sort( &#123; -.value &#125; )\             # sort descending</div><div class="line">    .[ ^10 ];                         # 10 most common words</div><div class="line"></div><div class="line">`#(</div><div class="line">*.Str</div><div class="line">I =&gt; I I I I, On =&gt; On On, a =&gt; a a a, black =&gt; black black black black black, day =&gt; day day day day, love =&gt; love, read =&gt; read, summer =&gt; summer summer, sunny =&gt; sunny sunny, to =&gt; to</div><div class="line"></div><div class="line"> .map(&#123;; .key =&gt; .value.elems &#125;)\</div><div class="line">On =&gt; 2 a =&gt; 3 sunny =&gt; 2 summer =&gt; 2 day =&gt; 4 I =&gt; 4 black =&gt; 5 love =&gt; 1 to =&gt; 1 read =&gt; 1  </div><div class="line"></div><div class="line"> .sort( &#123; -.value &#125; )\</div><div class="line">black =&gt; 5 day =&gt; 4 I =&gt; 4 a =&gt; 3 On =&gt; 2 sunny =&gt; 2 summer =&gt; 2 love =&gt; 1 to =&gt; 1 read =&gt; 1  </div><div class="line">)</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">class Student &#123;</div><div class="line">    has Str $.name;</div><div class="line">    has Int $.grade is rw;</div><div class="line">&#125;</div><div class="line">my $stu1 = Student.new(name =&gt; &quot;zhangwuji&quot;, grade =&gt; 124);</div><div class="line">my $stu2 = Student.new(name =&gt; &quot;yangguo&quot;,   grade =&gt; 128);</div><div class="line">my $stu3 = Student.new(name =&gt; &quot;zhaomin&quot;,   grade =&gt; 145);</div><div class="line">my $stu4 = Student.new(name =&gt; &quot;sunyizhe&quot;,  grade =&gt; 134);</div><div class="line"></div><div class="line">my @students = $stu1, $tu2,$stu3,$stu4;</div><div class="line">my Student @students = get-students();</div><div class="line"></div><div class="line">for @students.classify( *.grade ).sort -&gt; $group &#123;</div><div class="line">    say &quot;These students got grade $group.key():&quot;;</div><div class="line">    say .name for $group.value.list;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="pick-and-roll"><a href="#pick-and-roll" class="headerlink" title=".pick and .roll"></a>.pick and .roll</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"></div><div class="line">say @deck.pick();                   # pick a card, any card...</div><div class="line"></div><div class="line">say @deck.pick(5);                  # poker hand</div><div class="line"></div><div class="line">my @shuffled = @deck.pick(*);       # here, &apos;*&apos; means &apos;keep going&apos;</div><div class="line"></div><div class="line">my @urn = &lt;black white white&gt;;      # beads, 1/3 black, 2/3 white</div><div class="line">.say for @urn.roll(50);             # like .pick, but new each time</div><div class="line"></div><div class="line">for @urn.roll(*) &#123;</div><div class="line">    .say;                           # infinite bead selector</div><div class="line">&#125;</div><div class="line"></div><div class="line">say [+] (1..6).roll(4);             # 4d6</div><div class="line"></div><div class="line">class Enemy &#123;</div><div class="line">    method attack-with-arrows   &#123; say &quot;peow peow peow&quot;    &#125;</div><div class="line">    method attack-with-swords   &#123; say &quot;swish cling clang&quot; &#125;</div><div class="line">    method attack-with-fireball &#123; say &quot;sssSSS fwoooof&quot;    &#125;</div><div class="line">    method attack-with-camelia  &#123; say &quot;flap flap RAWWR!&quot;  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $selector = &#123; .name ~~ /^ &apos;attack-with-&apos; / &#125;;</div><div class="line">given Enemy.new -&gt; $e &#123;</div><div class="line">    my $attack-strategy</div><div class="line">        = $e.^methods().grep($selector).pick();</div><div class="line"></div><div class="line">    $e.$attack-strategy();           # call a random method</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="sort"><a href="#sort" class="headerlink" title=".sort"></a>.sort</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"># 1 if $a is higher, -1 if $b is higher, 0 if equal</div><div class="line">$a &lt;=&gt; $b;</div><div class="line"></div><div class="line"># 根据分数排序 students</div><div class="line">@students.sort: -&gt; $a, $b &#123; $a.grade &lt;=&gt; $b.grade &#125;;</div><div class="line"></div><div class="line"># same thing</div><div class="line">@students.sort: &#123; $^a.grade &lt;=&gt; $^b.grade &#125;;</div><div class="line"></div><div class="line"># same thing</div><div class="line">@students.sort: &#123; .grade &#125;;</div><div class="line"></div><div class="line"># same thing</div><div class="line">@students.sort: *.grade;</div><div class="line"></div><div class="line"># leg gives -1, 0 or 1 according to lexicographic ordering</div><div class="line"># &apos;leg&apos; is for Str, &apos;cmp&apos; is now for type-agnostic sort</div><div class="line">$a leg $b;</div><div class="line"></div><div class="line"># sort students by name (Unicode order)</div><div class="line">@students.sort: &#123; $^a.name leg $^b.name &#125;;</div><div class="line"></div><div class="line"># same thing</div><div class="line">@students.sort: *.name;</div><div class="line"></div><div class="line"># don&apos;t worry, things are properly cached; no re-evaluations</div><div class="line">@items.sort: *.expensive-calculation();</div><div class="line"></div><div class="line"># ...which means this works (and is a fair shuffle)</div><div class="line">@deck.sort: &#123; rand &#125;</div><div class="line"></div><div class="line"># ...but this is cuter :)</div><div class="line">@deck.pick(*);</div></pre></td></tr></table></figure>
<h3 id="操作符重载"><a href="#操作符重载" class="headerlink" title="操作符重载"></a>操作符重载</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">sub infix:&lt;±&gt;($number, $fuzz) &#123;</div><div class="line">    $number - $fuzz + rand * 2 * $fuzz;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say 15 ± 5;                          # somewhere between 10 and 20</div><div class="line"></div><div class="line">sub postfix:&lt;!&gt;($n) &#123; [*] 1..$n &#125;</div><div class="line">say 5!;                              # 120</div><div class="line"></div><div class="line">class Physical::Unit &#123;</div><div class="line">    has Int $.kg = 0;                # these attrs denote powers of units</div><div class="line">    has Int $.m  = 0;                # eg $.kg == 2 means that this object</div><div class="line">    has Int $.s  = 0;                # has a kg**2 unit</div><div class="line"></div><div class="line">    has Numeric $.payload;</div><div class="line"></div><div class="line">    method multiply(Physical::Unit $other) &#123;</div><div class="line">        Physical::Unit.new(</div><div class="line">            :kg( $.kg + $other.kg ),</div><div class="line">            :m( $.m + $other.m ),</div><div class="line">            :s( $.s + $other.s ),</div><div class="line">            :payload( $.payload * $other.payload )</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method invert() &#123;</div><div class="line">        Physical::Unit.new(</div><div class="line">            :kg( -$.kg ), :m( -$.m ), :s( -$.s ),</div><div class="line">            :payload( 1 / $.payload )</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method Str &#123;</div><div class="line">        $.payload</div><div class="line">        ~ ($.kg ?? ($.kg == 1 ?? &quot; kg&quot; !! &quot;kg**$.kg&quot;) !! &quot;&quot;)</div><div class="line">        ~ ($.m  ?? ($.m  == 1 ?? &quot; m&quot;  !! &quot;m**$.m&quot;)   !! &quot;&quot;)</div><div class="line">        ~ ($.s  ?? ($.s  == 1 ?? &quot; s&quot;  !! &quot;s**$.s&quot;)   !! &quot;&quot;)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">sub postfix:&lt;kg&gt;(Numeric $payload) &#123; Physical::Unit.new( :kg(1), :$payload ) &#125;</div><div class="line">sub postfix:&lt;m&gt;(Numeric $payload) &#123; Physical::Unit.new( :m(1), :$payload ) &#125;</div><div class="line">sub postfix:&lt;s&gt;(Numeric $payload) &#123; Physical::Unit.new( :s(1), :$payload ) &#125;</div><div class="line"></div><div class="line"># Note how we now use &apos;multi sub&apos;, so as not to shadow the original infix:&lt;*&gt;</div><div class="line">multi sub infix:&lt;*&gt;(Physical::Unit $a, $b) &#123;</div><div class="line">    $a.clone( :payload($a.payload * $b) );</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub infix:&lt;*&gt;($a, Physical::Unit $b) &#123;</div><div class="line">    $b.clone( :payload($a * $b.payload) );</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub infix:&lt;*&gt;(Physical::Unit $a, Physical::Unit $b) &#123;</div><div class="line">    $a.multiply($b);</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub infix:&lt;/&gt;(Physical::Unit $a, $b) &#123;</div><div class="line">    $a.clone( :payload($a.payload / $b) );</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub infix:&lt;/&gt;($a, Physical::Unit $b) &#123;</div><div class="line">    $b.invert.clone( :payload($a / $b.payload) );</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi sub infix:&lt;/&gt;(Physical::Unit $a, Physical::Unit $b) &#123;</div><div class="line">    $a.multiply($b.invert);</div><div class="line">&#125;</div><div class="line"></div><div class="line">say 5m / 2s;                         # 2.5 m s**-1</div><div class="line">say 100kg * 2m / 5s;                 # 40 kg m s**-1</div></pre></td></tr></table></figure>
<h3 id="Z"><a href="#Z" class="headerlink" title="Z"></a>Z</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"># Z (the &apos;zip operator&apos;) means &quot;mix these lists together&quot;</div><div class="line">my @tastes = &lt;spicy sweet bland&gt;;</div><div class="line">my @foods = &lt;soup potatoes tofu&gt;;</div><div class="line">@tastes Z @foods; # &lt;spicy soup sweet potatoes bland tofu&gt;</div><div class="line"></div><div class="line">class Student &#123;</div><div class="line">    has Str $.name;</div><div class="line">    has Int $.grade is rw;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $stu1 = Student.new(name =&gt; &quot;zhangwuji&quot;, grade =&gt; 124);</div><div class="line">my $stu2 = Student.new(name =&gt; &quot;yangguo&quot;,   grade =&gt; 128);</div><div class="line">my $stu3 = Student.new(name =&gt; &quot;zhaomin&quot;,   grade =&gt; 145);</div><div class="line">my $stu4 = Student.new(name =&gt; &quot;sunyizhe&quot;,  grade =&gt; 145);</div><div class="line">my $stu5 = Student.new(name =&gt; &quot;zhouziruo&quot;, grade =&gt; 128);</div><div class="line">my $stu6 = Student.new(name =&gt; &quot;qiaofeng&quot;,  grade =&gt; 124);</div><div class="line"></div><div class="line">my @students = $stu1, $stu2,$stu3,$stu4,$stu5,$stu6;</div><div class="line"># » 为每个元素调用方法</div><div class="line">.say for @students».grade;   # all the grades</div><div class="line"></div><div class="line">for @students».name Z @students».grade -&gt; $name, $grade &#123;</div><div class="line">    say &quot;$name got a $grade this year&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Note that the latter list is infinite -- it works anyway</div><div class="line">for @students».name Z (1..6).roll(*) -&gt; $name, $roll &#123;</div><div class="line">    say &quot;$name rolls a $roll&quot;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># you can also Z together two lists with an infix op</div><div class="line">my @total-scores = @first-scores Z+ @second-scores;</div><div class="line"></div><div class="line"># strings as keys, the appropriate number of 1s as values</div><div class="line">my %hash = @names Z=&gt; 1 xx *;    # xx is list repeat</div><div class="line"></div><div class="line"># line people up with increasing numbers</div><div class="line">my %people2numbers = @people Z=&gt; 1..*;</div><div class="line"></div><div class="line"># don&apos;t have a good op? roll your own!</div><div class="line">sub infix:&lt;likes&gt;($liker, $likee) &#123; &quot;$liker is fond of $likee&quot; &#125;</div><div class="line"># note how the op infix:&lt;Zlikes&gt; is automatically available</div><div class="line">my @relations = @likers Zlikes @likees;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&gt; sub infix:&lt;likes&gt;($liker, $likee) &#123; &quot;$liker is fond of $likee&quot; &#125;</div><div class="line">sub infix:&lt;likes&gt; (Any $liker, Any $likee) &#123; #`(Sub+&#123;Precedence&#125;|140676897934560) ... &#125;</div><div class="line">&gt; &quot;aaa&quot; likes &quot;bbb&quot;</div><div class="line">aaa is fond of bbb</div><div class="line">&gt; my @a = &lt;a b c&gt;;</div><div class="line">a b c</div><div class="line">&gt; my @b = &lt;1 2 3&gt;;</div><div class="line">1 2 3</div><div class="line">&gt; @a Zlikes @b</div><div class="line">a is fond of 1 b is fond of 2 c is fond of 3</div><div class="line">&gt; .say for @a Zlikes @b</div><div class="line">a is fond of 1</div><div class="line">b is fond of 2</div><div class="line">c is fond of 3</div></pre></td></tr></table></figure>
<h3 id="infix-lt-…-gt"><a href="#infix-lt-…-gt" class="headerlink" title="infix:&lt;…&gt;"></a>infix:&lt;…&gt;</h3><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line">1 ... $n                                    # integers 1 to $n</div><div class="line">$n ... 1                                    # and backwards</div><div class="line"></div><div class="line">1, 3 ... $n                                 # odd numbers to $n</div><div class="line">1, 3, ... *                                 # odd numbers</div><div class="line">1, 2, 4 ... *                               # powers of two</div><div class="line">map &#123; $_ * $_ &#125;, (1 ... *)                  # squares</div><div class="line"></div><div class="line">1, 1, -&gt; $a, $b &#123; $a + $b &#125; ... *           # fibonacci</div><div class="line">1, 1, &#123; $^a + $^b &#125; ... *                   # ditto</div><div class="line">1, 1, *+* ... *                             # ditto</div><div class="line"></div><div class="line">&apos;Camelia&apos;, *.chop ... &apos;&apos;;                   # all prefixes of &apos;Camelia&apos;</div><div class="line"># Camelia Cameli Camel Came Cam Ca C</div><div class="line"># See http://blog.plover.com/CS/parentheses.html</div><div class="line"># for the principle behind this</div><div class="line">sub next-balanced-paren-string($s) &#123;</div><div class="line">    $s ~~ /^ ( &apos;(&apos;+ ) ( &apos;)&apos;+ ) &apos;(&apos; /;</div><div class="line">    [~] $s.substr(0, $/.from),</div><div class="line">        &quot;()&quot; x ($1.chars - 1),</div><div class="line">        &quot;(&quot; x ($0.chars - $1.chars + 2),</div><div class="line">        &quot;)&quot;,</div><div class="line">        $s.substr($/.to);</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $N = 3;</div><div class="line"></div><div class="line">my $start = &quot;()&quot; x $N;</div><div class="line">my &amp;step = &amp;next-balanced-paren-string;</div><div class="line">my $end = &quot;(&quot; x $N ~ &quot;)&quot; x $N;</div><div class="line"></div><div class="line">for $start, &amp;step ... $end -&gt; $string &#123;</div><div class="line">    say $string;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># Output:</div><div class="line"># ()()()</div><div class="line"># (())()</div><div class="line"># ()(())</div><div class="line"># (()())</div><div class="line"># ((()))</div></pre></td></tr></table></figure>
<h2 id="Chained-Comparisons"><a href="#Chained-Comparisons" class="headerlink" title="Chained Comparisons"></a>Chained Comparisons</h2><hr>
<h2 id="Muti-dispatch"><a href="#Muti-dispatch" class="headerlink" title="Muti dispatch"></a>Muti dispatch</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">multi foo(Int $x) &#123; 1 &#125;</div><div class="line">multi foo(Int $x) is default &#123; 2 &#125;</div><div class="line">say foo(1); # 2</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"># Operator overloading in Perl 6 will be done by multi-dispatch routines</div><div class="line"># (In fact, all of the built-in operators are invoked by a multi-dispatch.</div><div class="line"></div><div class="line"># Dispatch By Arity</div><div class="line"># 􏰀 Arity = number of arguments that a routine takes</div><div class="line">#􏰀  Could do the previous example as:</div><div class="line"></div><div class="line">multi sub greet($name) &#123;</div><div class="line">    say &quot;Ahoj, $name!&quot;;</div><div class="line">&#125;</div><div class="line">multi sub greet($name, $greeting) &#123;</div><div class="line">    say &quot;$greeting, $name!&quot;;</div><div class="line">&#125;</div><div class="line">greet(&apos;Anna&apos;); # Ahoj Anna</div><div class="line">greet(&apos;Лена&apos;, &apos;Привет &apos;); # Привет, Лена&quot;</div><div class="line"></div><div class="line"># Type-Based Dispatch</div><div class="line">#  􏰀 We can write types in a signature</div><div class="line">#􏰀   They are used to help decide which candidate to call</div><div class="line"></div><div class="line">multi sub double(Int $x) &#123;</div><div class="line">    return 2 * $x;</div><div class="line">&#125;</div><div class="line">multi sub double(Str $x) &#123;</div><div class="line">    return &quot;$x $x&quot;;</div><div class="line">&#125;</div><div class="line">say double(21);      # 42</div><div class="line">say double(&quot;he&quot;);   # he he</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">multi sub MAIN(&apos;send&apos;, $filename) &#123;</div><div class="line"> ...</div><div class="line">&#125;</div><div class="line">multi sub MAIN(&apos;fetch&apos;, $filename) &#123;</div><div class="line"> ...</div><div class="line">&#125;</div><div class="line">multi sub MAIN(&apos;compare&apos;, $file1, $file2) &#123;</div><div class="line"> ...</div><div class="line">&#125;</div><div class="line"></div><div class="line">#`(</div><div class="line">... 是 yadayadayada 占位符</div><div class="line">&gt; perl6 &quot;multiple_MAIN.p6&quot;</div><div class="line">Usage:</div><div class="line">  multiple _MAIN.p6 send &lt;filename&gt;</div><div class="line">  multiple _MAIN.p6 fetch &lt;filename&gt;</div><div class="line">  multiple _MAIN.p6 compare &lt;file1&gt; &lt;file2&gt;</div><div class="line">)</div></pre></td></tr></table></figure>
<h2 id="Module-management"><a href="#Module-management" class="headerlink" title="Module management"></a>Module management</h2><hr>
<h2 id="Native-Library-Calls"><a href="#Native-Library-Calls" class="headerlink" title="Native Library Calls"></a>Native Library Calls</h2><hr>
<h2 id="Operators"><a href="#Operators" class="headerlink" title="Operators"></a>Operators</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">my @suits  = &lt;♣ ♢ ♡ ♠&gt;;</div><div class="line">my @ranks  = 2..10, &lt;J Q K A&gt;;</div><div class="line"></div><div class="line"># concatenate each rank with each suit (2♣ 2♢ 2♡ ... A♠)</div><div class="line">my @deck = @ranks X~ @suits;</div><div class="line"></div><div class="line"># build a hash of card names to point values</div><div class="line"># 52 张牌， 4 种花色， A 的值为 11 ， J、Q、K 为 10</div><div class="line">my %points = @deck Z @( (2..10, 10, 10, 10, 11) Xxx 4 );</div><div class="line"></div><div class="line"># 把牌打乱</div><div class="line">@deck .= pick(*); # shuffle the deck</div><div class="line">my @hand = @deck.splice(0, 5); # 抓取前 5 张牌</div><div class="line">say ~@hand; #  显示抓取的是哪 5 张</div><div class="line">say [+] %points&#123;@hand&#125;; # 这 5 张牌面的值加起来是多少</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">sub postfix:&lt;!&gt;($n where $n &gt; 0) &#123;</div><div class="line">   [*] 2..$n</div><div class="line">&#125;</div><div class="line">say 5!;</div><div class="line"></div><div class="line">constant fact = 1, [\*] 1..*;</div><div class="line">say fact[5];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">my $file = open &apos;flip_flop.txt&apos;;</div><div class="line">for $file.lines -&gt; $line &#123;</div><div class="line">say $line if !($line ~~ m/^\;/ ff $line ~~ m/^\&quot;/);</div><div class="line">&#125;</div><div class="line"></div><div class="line">#`(</div><div class="line">flip_flop.txt 内容如下：</div><div class="line">; next is some lines to skip,include this line</div><div class="line">fuck fuck fuck</div><div class="line">dam dam dam</div><div class="line">mie mie mie</div><div class="line">&quot; next is subject</div><div class="line">There is more than one way to do it</div><div class="line">                                -- Larry Wall</div><div class="line"></div><div class="line">We hope Perl6 is wrote by the hole Socfilia</div><div class="line">                                -- Larry Wall</div><div class="line">; next is some lines to skip,include this line</div><div class="line">fuck fuck fuck</div><div class="line">dam dam dam</div><div class="line">mie mie mie</div><div class="line">&quot; next is subject</div><div class="line">programming is hard,Let&apos;s go shopping</div><div class="line">                               -- Larry Wall</div><div class="line">Ruby is Another Perl6</div><div class="line">                               -- Larry Wall</div><div class="line">输出：</div><div class="line">There is more than one way to do it</div><div class="line">                                -- Larry Wall</div><div class="line">We hope Perl6 is wrote by the hole Socfilia</div><div class="line">                                -- Larry Wall</div><div class="line">programming is hard,Let&apos;s go shopping</div><div class="line">                               -- Larry Wall</div><div class="line">Ruby is Another Perl6</div><div class="line">                               -- Larry Wall</div><div class="line">圣诞节中的例子：</div><div class="line"></div><div class="line">)</div><div class="line">for 1..20 &#123;.say if $_==9 ff $_==16&#125;</div><div class="line">say &apos;-&apos; x 10;</div><div class="line">for 1..20 &#123;.say if $_==9 ^ff $_==16&#125;</div><div class="line">say &apos;-&apos; x 10;</div><div class="line">for 1..20 &#123;.say if $_==9 ff^ $_==16&#125;</div><div class="line">say &apos;-&apos; x 10;</div><div class="line">for 1..20 &#123;.say if $_==9 ^ff^ $_==16&#125;</div></pre></td></tr></table></figure>
<h2 id="Awesome-Operators"><a href="#Awesome-Operators" class="headerlink" title="Awesome Operators"></a>Awesome Operators</h2><hr>
<p>In Perl 6 we have a few new operators…</p>
<h2 id="Junctions-1"><a href="#Junctions-1" class="headerlink" title="Junctions"></a>Junctions</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if $status eq &apos;error&apos; || $status eq &apos;warning&apos; &#123;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在 Perl 6 里面:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">if $status eq &apos;error&apos; | &apos;warning&apos; &#123;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Perl 5 里面:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">while $value &lt; $limit1 &amp;&amp; $value &lt; $limit2 &#123;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Perl 6 里面</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">while $value &lt; $limit1 &amp; $limit2 &#123;</div><div class="line">...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>Sequences</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">say 1, 2, 4 ... 1024;</div><div class="line">1 2 4 8 16 32 64 128 256 512 1024</div><div class="line"></div><div class="line">my @fib = 1, 1, *+* ... *;</div><div class="line">say @fib[0..9]</div><div class="line">1 1 2 3 5 8 13 21 34 55 89</div></pre></td></tr></table></figure>
<ul>
<li>^ (zero up to…)</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">my @fib = 1, 1, *+* ... *;</div><div class="line">say @fib[^10]</div><div class="line">1 1 2 3 5 8 13 21 34 55 89</div></pre></td></tr></table></figure>
<ul>
<li>Awesome Meta-operators</li>
<li>Higher order operators</li>
<li><p>Operators that <strong>operate on operators</strong></p>
</li>
<li><p>Reduction<br>Puts an operator between every element in a list</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">say [*] 1..10</div><div class="line">3628800</div><div class="line"></div><div class="line">my @sorted = 1,4,7,9,11;</div><div class="line">my @unsorted = 3, 1, 9, 25;</div><div class="line"></div><div class="line">say [&lt;] @sorted;</div><div class="line">say [&lt;] @unsorted;</div><div class="line"></div><div class="line">Bool::True</div><div class="line">Bool::False</div></pre></td></tr></table></figure>
<ul>
<li>Zip<br>Take elements from two or more lists and combine them with some operator</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">say 1 .. 6 Z~ &apos;A&apos;..&apos;F’</div><div class="line">1A 2B 3C 4D 5E 6F</div></pre></td></tr></table></figure>
<ul>
<li>Cross</li>
<li>All permutations of two or more lists, combined with some operator</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">say 1 .. 3 X~ &apos;A&apos;..&apos;F‘</div><div class="line">1A 1B 1C 1D 1E 1F 2A 2B 2C 2D 2E 2F 3A 3B 3C 3D 3E 3F</div></pre></td></tr></table></figure>
<ul>
<li><p>Your Awesome Operators</p>
<p>What if Perl 6 built in operators are not enough?</p>
<p>You can add your own!</p>
</li>
<li><p>Factorial<br>Add a ! operator to do factorial</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sub postfix:&lt;!&gt;($n) &#123; [*] 1..$n &#125;</div><div class="line">say 10!</div><div class="line">3628800</div></pre></td></tr></table></figure>
<pre><code># And you have all of unicode!
# Insert In Middle
## Operator to add an element to the middle of an array
</code></pre><ul>
<li>中</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">sub infix:&lt;中&gt;(@array, $ins) &#123;</div><div class="line">    @array.splice(+@array / 2, 0, $ins);</div><div class="line">    return @array;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @a = 1,2,4,5;</div><div class="line">say @a 中 3;</div><div class="line"></div><div class="line">1 2 3 4 5</div></pre></td></tr></table></figure>
<h2 id="Feeds"><a href="#Feeds" class="headerlink" title="Feeds"></a>Feeds</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">use Test;</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">    my @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    my @odds = &lt;1 5 7&gt;;</div><div class="line"></div><div class="line">    eval_dies_ok(&apos;@data &lt;== grep &#123;$_ % 2&#125; &lt;== @data&apos;, &apos;a chain of feeds may not begin and end with the same array&apos;);</div><div class="line"></div><div class="line">    @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    @data &lt;== grep &#123;$_ % 2&#125; &lt;== eager @data;</div><div class="line">    # rakudo 2 todo &apos;feeds + eager&apos;</div><div class="line">    is(~@data, ~@odds, &apos;@arr &lt;== grep &lt;== eager @arr works&apos;);</div><div class="line"></div><div class="line">    @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    @data &lt;== eager grep &#123;$_ % 2&#125; &lt;== @data;</div><div class="line">    is(~@data, ~@odds, &apos;@arr &lt;== eager grep &lt;== @arr works&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">use Test;</div><div class="line"></div><div class="line"># L&lt;S06/&quot;Feed operators&quot;&gt;</div><div class="line"># L&lt;S03/&quot;Feed operators&quot;&gt;</div><div class="line"></div><div class="line">=begin pod</div><div class="line"></div><div class="line">Tests for the feed operators</div><div class="line"></div><div class="line">    ==&gt; and &lt;==</div><div class="line"></div><div class="line">=end pod</div><div class="line"></div><div class="line">plan 24;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    my @a = (1, 2);</div><div class="line">    my (@b, @c);</div><div class="line"></div><div class="line">    @a ==&gt; @b;</div><div class="line">    @c &lt;== @a;</div><div class="line"></div><div class="line">    is(~@b, ~@a, &quot;ltr feed as simple assignment&quot;);</div><div class="line">    is(~@c, ~@a, &quot;rtl feed as simple assignment&quot;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    my @a = (1 .. 5);</div><div class="line">    my @e = (2, 4);</div><div class="line"></div><div class="line">    my (@b, @c);</div><div class="line">    @a ==&gt; grep &#123; ($_ % 2) == 0 &#125; ==&gt; @b;</div><div class="line">    @c &lt;== grep &#123; ($_ % 2) == 0 &#125; &lt;== @a;</div><div class="line">    my @f = do &#123;@a ==&gt; grep &#123;($_ % 2) == 0&#125;&#125;;</div><div class="line">    my @g = (@a ==&gt; grep &#123;($_ % 2) == 0&#125;);</div><div class="line"></div><div class="line">    is(~@b, ~@e, &quot;array ==&gt; grep ==&gt; result&quot;);</div><div class="line">    is(~@c, ~@e, &quot;result &lt;== grep &lt;== array&quot;);</div><div class="line">    is(~@f, ~@e, &apos;result = do &#123;array ==&gt; grep&#125;&apos;);</div><div class="line">    is(~@g, ~@e, &apos;result = (array ==&gt; grep)&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    my ($got_x, $got_y, @got_z);</div><div class="line">    sub foo ($x, $y?, *@z) &#123;</div><div class="line">        $got_x = $x;</div><div class="line">        $got_y = $y;</div><div class="line">        @got_z = @z;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    my @a = (1 .. 5);</div><div class="line"></div><div class="line">    @a ==&gt; foo &quot;x&quot;;</div><div class="line"></div><div class="line">    is($got_x, &quot;x&quot;, &quot;x was passed as explicit param&quot;);</div><div class="line">    #?rakudo 2 todo &apos;feeds + signatures&apos;</div><div class="line">    ok(!defined($got_y), &quot;optional param y was not bound to fed list&quot;);</div><div class="line">    is(~@got_z, ~@a, &apos;...slurpy array *@z got it&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line">&#123;</div><div class="line">    my @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    my @odds = &lt;1 5 7&gt;;</div><div class="line"></div><div class="line">    eval_dies_ok(&apos;@data &lt;== grep &#123;$_ % 2&#125; &lt;== @data&apos;, &apos;a chain of feeds may not begin and end with the same array&apos;);</div><div class="line"></div><div class="line">    @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    @data &lt;== grep &#123;$_ % 2&#125; &lt;== eager @data;</div><div class="line">    #?rakudo 2 todo &apos;feeds + eager&apos;</div><div class="line">    is(~@data, ~@odds, &apos;@arr &lt;== grep &lt;== eager @arr works&apos;);</div><div class="line"></div><div class="line">    @data = &lt;1 2 4 5 7 8&gt;;</div><div class="line">    @data &lt;== eager grep &#123;$_ % 2&#125; &lt;== @data;</div><div class="line">    is(~@data, ~@odds, &apos;@arr &lt;== eager grep &lt;== @arr works&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"># checking the contents of a feed: installing a tap</div><div class="line">&#123;</div><div class="line">    my @data = &lt;0 1 2 3 4 5 6 7 8 9&gt;;</div><div class="line">    my @tap;</div><div class="line"></div><div class="line">    @data &lt;== map &#123;$_ + 1&#125; &lt;== @tap &lt;== grep &#123;$_ % 2&#125; &lt;== eager @data;</div><div class="line">    is(@tap, &lt;1 3 5 7 9&gt;, &apos;@tap contained what was expected at the time&apos;);</div><div class="line">    #?rakudo todo &apos;feeds + eager&apos;</div><div class="line">    is(@data, &lt;2 4 6 8 10&gt;, &apos;final result was unaffected by the tap variable&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"># &lt;&lt;== and ==&gt;&gt; pretending to be unshift and push, respectively</div><div class="line"># rakudo skip &apos;double-ended feeds&apos;</div><div class="line">&#123;</div><div class="line">    my @odds = &lt;1 3 5 7 9&gt;;</div><div class="line">    my @even = &lt;0 2 4 6 8&gt;;</div><div class="line"></div><div class="line">    my @numbers = do &#123;@odds ==&gt;&gt; @even&#125;;</div><div class="line">    is(~@numbers, ~(@even, @odds), &apos;basic ==&gt;&gt; test&apos;);</div><div class="line"></div><div class="line">    @numbers = do &#123;@odds &lt;&lt;== @even&#125;;</div><div class="line">    is(~@numbers, ~(@odds, @even), &apos;basic &lt;&lt;== test&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"># feeding to whatever using ==&gt; and ==&gt;&gt;</div><div class="line"></div><div class="line"># rakudo skip &apos;double-ended feeds&apos;</div><div class="line">&#123;</div><div class="line">    my @data = &apos;a&apos; .. &apos;e&apos;;</div><div class="line"></div><div class="line">    @data ==&gt; *;</div><div class="line">    is(@(*), @data, &apos;basic feed to whatever&apos;);</div><div class="line"></div><div class="line">    &lt;a b c d&gt; ==&gt;  *;</div><div class="line">    0 .. 3    ==&gt;&gt; *;</div><div class="line">    is(@(*), &lt;a b c d 0 1 2 3&gt;, &apos;two feeds to whatever as array&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"># feed and Inf</div><div class="line"># nieza skip &quot;unhandled exception</div><div class="line">&#123;</div><div class="line">  lives_ok &#123; my @a &lt;== 0..Inf &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># nieza skip &quot;Unhandled exception&quot;</div><div class="line">&#123;</div><div class="line">  my $call-count = 0;</div><div class="line">  my @a &lt;== gather for 1..10 -&gt; $i &#123; $call-count++; take $i &#125;;</div><div class="line">  @a[0];</div><div class="line">  #?rakudo todo &quot;isn&apos;t lazy&quot;</div><div class="line">  is $call-count, 1;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># no need for temp variables in feeds: $(*), @(*), %(*)</div><div class="line"># rakudo skip &apos;* feeds&apos;</div><div class="line"># DOES 4</div><div class="line">&#123;</div><div class="line">    my @data = &apos;a&apos; .. &apos;z&apos;;</div><div class="line">    my @out  = &lt;a e i o u y&gt;;</div><div class="line"></div><div class="line">    @data ==&gt; grep &#123;/&lt;[aeiouy]&gt;/&#125; ==&gt; is($(*), $(@out), &apos;basic test for $(*)&apos;);</div><div class="line">    @data ==&gt; grep &#123;/&lt;[aeiouy]&gt;/&#125; ==&gt; is(@(*), @(@out), &apos;basic test for @(*)&apos;);</div><div class="line">    @data ==&gt; grep &#123;/&lt;[aeiouy]&gt;/&#125; ==&gt; is(%(*), %(@out), &apos;basic test for %(*)&apos;);</div><div class="line"></div><div class="line">    # XXX: currently the same as the @(*) test above. Needs to be improved</div><div class="line">    @data ==&gt; grep &#123;/&lt;[aeiouy]&gt;/&#125; ==&gt; is(@(*).slice, @(@out).slice, &apos;basic test for @(*).slice&apos;);</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line">done;</div><div class="line"></div><div class="line"># vim: ft=perl6</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">use Test;</div><div class="line">&#123;</div><div class="line">    my ($got_x, $got_y, @got_z);</div><div class="line">    sub foo ($x, $y?, *@z) &#123;</div><div class="line">        $got_x = $x;</div><div class="line">        $got_y = $y;</div><div class="line">        @got_z = @z;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    my @a = (1 .. 5);</div><div class="line"></div><div class="line">    @a ==&gt; foo &quot;x&quot;;</div><div class="line"></div><div class="line">    is($got_x, &quot;x&quot;, &quot;x was passed as explicit param&quot;);</div><div class="line">    # rakudo 2 todo &apos;feeds + signatures&apos;</div><div class="line">    ok(!defined($got_y), &quot;optional param y was not bound to fed list&quot;);</div><div class="line">    is(~@got_z, ~@a, &apos;...slurpy array *@z got it&apos;);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">﻿my @a =slurp(&apos;Hamlet.txt&apos;).comb(/\w+/);</div><div class="line">my @result = (@a ==&gt; sort *.chars ==&gt;  reverse @() ==&gt; join &quot;\n&quot;);</div><div class="line">say  @result; # @() 不使用临时数组存储中间变量</div></pre></td></tr></table></figure>
<h2 id="Hyper-Operator"><a href="#Hyper-Operator" class="headerlink" title="Hyper Operator"></a>Hyper Operator</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">sub add($x) &#123;</div><div class="line">    sleep 3;</div><div class="line">    $x ** 2 + 1;</div><div class="line">&#125;</div><div class="line"># hyper  运算符现在还未实现并行， 该程序 sleep 了 9 秒</div><div class="line">my @array = 1, 3, 5;</div><div class="line">.say for @array».&amp;add;</div></pre></td></tr></table></figure>
<p>超运算符能运用在自定义的子例程上面：</p>
<p>为什么会使用 <code>.&amp;</code> 语法呢？<br>因为 $obj.method 确实是一个方法调用， 而 <code>$obj.$coderef</code> 不是<br>add 函数的名字是 <code>&amp;add</code>,  就像 foo 标量的名字是 <code>$foo</code>, 数组 foo 的名字叫做 @foo 一样<br>在 Perl 6 中， 如果你提到一个子例程却不带 &amp; 符号， 那就是调用了它。在 add 前面加上 &amp;  符号才能引用一个函数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&gt; sub add($x) &#123;$x * 2 + 1&#125;</div><div class="line">sub add (Any $x) &#123; #`(Sub|140286460109400) ... &#125;</div><div class="line">&gt; 2.add</div><div class="line">Method &apos;add&apos; not found for invocant of class &apos;Int&apos;</div><div class="line">&gt; 2.&amp;add</div><div class="line">5</div><div class="line">&gt; add(2)</div><div class="line">5</div><div class="line">&gt; my $function = sub add($x) &#123;$x * 2 + 1&#125;</div><div class="line">sub add (Any $x) &#123; #`(Sub|140286460109552) ... &#125;</div><div class="line">&gt; 2.$function</div><div class="line">5</div><div class="line">&gt; $function(2)</div><div class="line">5</div><div class="line">&gt; my @a = 1, 2, 3</div><div class="line">1 2 3</div><div class="line">&gt; @a&gt;&gt;.$function</div><div class="line">3 5 7</div><div class="line">&gt; say $function.WHAT</div><div class="line">(Sub)</div><div class="line"></div><div class="line"></div><div class="line">$obj.$function 等价于 $function($obj)</div></pre></td></tr></table></figure>
<h2 id="Meta-Operators"><a href="#Meta-Operators" class="headerlink" title="Meta Operators"></a>Meta Operators</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line">my @lines = slurp(&apos;3col.txt&apos;);</div><div class="line">for @lines -&gt; $line &#123;</div><div class="line">   my @b = $line.comb(/\d+/);</div><div class="line">   say &quot;@b[]&quot;;</div><div class="line">   say &quot;-&quot; x 45;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 没有打印出满意的结果, 因为 slurp 是把所有文本作为一个字符串吸入的.</div><div class="line"></div><div class="line">#`(</div><div class="line">my $fh = open(&apos;3col.txt&apos;);</div><div class="line">my $num;</div><div class="line">for $fh.lines -&gt; $line &#123;</div><div class="line">    $num += $line.words.[2];</div><div class="line">&#125;</div><div class="line">say $num;</div><div class="line">)</div><div class="line"></div><div class="line">my $fh = open(&apos;3col.txt&apos;);</div><div class="line"># say [+] ($fh.lines&gt;&gt;.words).[2];</div><div class="line">my @l = $fh.lines&gt;&gt;.comb(/\d+/);</div><div class="line">say @l.elems;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line"># 该源文件必须保存为 UTF8 格式 才不会报 UTF-8 错误, 即使是中文注释</div><div class="line"></div><div class="line">sub infix:&lt;中&gt;(@array, $ins) &#123;</div><div class="line">    @array.splice(+@array / 2, 0, $ins);</div><div class="line">    return @array;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my @a = 1,2,4,5;</div><div class="line">say @a 中 3;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># Loop over multiple arrays (or lists or tuples or whatever they&apos;re called in your language) and print the ith element of each. Use your language&apos;s &quot;for each&quot; loop if it has one, otherwise iterate through the collection in order with some other loop.</div><div class="line"></div><div class="line"># For this example, loop over the arrays (a,b,c), (A,B,C) and (1,2,3) to produce the output</div><div class="line"># aA1</div><div class="line"># bB2</div><div class="line"># cC3</div><div class="line"></div><div class="line">for &lt;a b c&gt; Z &lt;A B C&gt; Z 1, 2, 3 -&gt; $x, $y, $z &#123;</div><div class="line">   say $x, $y, $z;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># The Z operator stops emitting items as soon as the shortest input list is exhausted. However, short lists are easily extended by replicating all or part of the list, or by appending any kind of lazy list generator to supply default values as necessary.</div><div class="line"></div><div class="line"># Note that we can also factor out the concatenation by making the Z metaoperator apply the ~ concatenation operator across each triple:</div><div class="line">for &lt;a b c&gt; Z~ &lt;A B C&gt; Z~ 1, 2, 3 -&gt; $line &#123;</div><div class="line">   say $line;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># We could also use the zip-to-string with the reduction metaoperator:</div><div class="line">.say for [Z~] [&lt;a b c&gt;], [&lt;A B C&gt;], [1,2,3]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line"></div><div class="line">class PowerBy2 &#123;</div><div class="line">    has $.number;</div><div class="line"></div><div class="line">	method power_by2() &#123;</div><div class="line">	    return  $.number ** 2;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my  $test = PowerBy2.new(number=&gt;10);</div><div class="line">say $test.power_by2;</div><div class="line"></div><div class="line">my @a = &lt;1 2 3 4&gt;;</div><div class="line">my @b = @a&gt;&gt;.power_by2;</div><div class="line">say @b;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my @scores = &apos;Ana&apos; =&gt; 8, &apos;Dave&apos; =&gt; 6, &apos;Charlie&apos; =&gt; 4, &apos;Beth&apos; =&gt; 4;</div><div class="line"></div><div class="line">my $screen-width = 30;</div><div class="line"></div><div class="line">my $label-area-width = 1 + [max] @scores».key».chars;</div><div class="line">my $max-score = [max] @scores».value;</div><div class="line">my $unit = ($screen-width - $label-area-width) / $max-score;</div><div class="line">my $format = &apos;%- &apos; ~ $label-area-width ~ &quot;s%s\n&quot;;</div><div class="line"></div><div class="line">for @scores &#123;</div><div class="line">printf $format, .key, &apos;X&apos; x ($unit * .value);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line">use List::Utils;</div><div class="line"></div><div class="line">my @array = &lt;1 3 4 6 7&gt;;</div><div class="line">my @b = sliding-window(@array,2);</div><div class="line">.say for @b;</div><div class="line">say &apos;-&apos; x 15;</div><div class="line">my @c = combinations(@array);</div><div class="line">.say for @c;</div><div class="line">say &apos;-&apos; x 15;</div><div class="line"></div><div class="line">my @d = combinations(@array,3);</div><div class="line">.say for @d;</div><div class="line"></div><div class="line">say &apos;-&apos; x 15;</div><div class="line">my @e = combinations(@array,4);</div><div class="line">.say for @e;</div><div class="line"></div><div class="line">say &apos;-&apos; x 15;</div><div class="line">my @take = take-while((1...*), * &lt;= 10);</div><div class="line">.say for @take;</div><div class="line"></div><div class="line">say &apos;-&apos; x 15;</div><div class="line">my @takerange = take-while((1...*), * + 4 &lt; 10);</div><div class="line">.say for @takerange;</div><div class="line"></div><div class="line">say &apos;-&apos; x 15;</div><div class="line">my @aa = uniq-by(&lt;A B C a b c d D e&gt;, *.uc);</div><div class="line">my @bb = uniq-by((1..* Z -2..*), *.abs)[^10];</div><div class="line">my @cc = uniq-by((1..* Z -2..*), *+1)[^10];</div><div class="line">.say for @aa;</div><div class="line">say &apos;-&apos; x 15;</div><div class="line">.say for @bb;</div><div class="line">say &apos;-&apos; x 15;</div><div class="line">.say for @cc;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">use Test;</div><div class="line">use List::Utils;</div><div class="line"></div><div class="line">is take-while((1...*), * &lt;= 10), ~(1...10), &quot;take-while works on a basic infinite loop&quot;;</div><div class="line">is take-while((1...*), * &lt;= -1), &quot;&quot;, &quot;take-while works if condition is initially false&quot;;</div><div class="line"></div><div class="line">done;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">my @a = 0..9;</div><div class="line">my @b = &apos;a&apos;..&apos;z&apos;;</div><div class="line">my @guess = @a X~ @b;</div><div class="line">say @guess;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">﻿use v6;</div><div class="line">my @a=1,2,3;</div><div class="line">my @b=4,5,6;</div><div class="line">my @c=7,8,9;</div><div class="line">for zip(@a; @b; @c) -&gt; $a, $b, $c &#123;say $a,$b,$c;&#125;</div><div class="line"></div><div class="line"># 多行注释</div><div class="line">my $things = #`( i wonder how many of these</div><div class="line"> I will need, hm maybe 3, or 4, better 5 ) 5; # same as $things = 5;</div><div class="line">say $things;</div><div class="line"></div><div class="line">say Q/hello/;</div><div class="line">say Q&#123;world&#125;;</div><div class="line">say Q|1234|;</div><div class="line">say Q,comma,;</div><div class="line">say Q[maohao];</div><div class="line">say Q*askiles*;</div><div class="line">say Q:a/@a[0]/;  # 1</div><div class="line">say @a[1];</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my @a = &lt;王 孙 刘&gt;;</div><div class="line">my @b = &lt;伟 亦 百&gt;;</div><div class="line">my @c = &lt;霆 哲 爽&gt;;</div><div class="line">for zip(@a;@b;@c) -&gt; $a,$b,$c &#123;</div><div class="line">    say &quot;$a$b$c&quot;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">use v6;</div><div class="line"></div><div class="line">my @a=&lt;aa bb cc dd ee ff &gt;;</div><div class="line">for @a -&gt; $x,$y,$z &#123;</div><div class="line">    say $x,$y,$z;</div><div class="line">&#125;</div><div class="line">say $*PROGRAM_NAME;</div><div class="line">say $*CWD;</div><div class="line"># aabbcc</div><div class="line"># ddeeff</div><div class="line"># three.p6</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line">One place infinite lazy lists do not work are the hyper meta operators</div><div class="line">The idea is that conceptually they work on the entire list at once</div><div class="line">Indeed, they are allowed to work on its elements in any order, and in parallel</div><div class="line">(In practice, none of the Perl 6 compilers handle parallel processing yet)</div><div class="line">Our first example of a meta operator: an operator built from a simpler operator</div><div class="line">@a »+« @b produces an array which is the sum of the other two arrays</div><div class="line">@a »%%» 2 produces an array of Bools telling which elements of @a are divisible by 2</div><div class="line">~«@a is effectively the same as @a».Str -- it returns an array of strings</div><div class="line"></div><div class="line">当无限惰性列表遇到 hyper 元操作符时, 就不起作用了。从概念上来讲, 它们实际上立即作用于整个列表, 它们被允许以任意顺序作用它们的元素</div><div class="line">还能并行。（事实上, 目前没有一个 Perl 6 编译器能处理并行）</div><div class="line">我们第一个关于元操作符的例子：一个构建自简单操作符的操作符 `@a »+« @b` 生成了一个数组, 这个数组是另外两个数组对应元素的和。</div><div class="line">@a »%%» 2 生成一个布尔值的数组, @a 中的哪个元素能被 2 整除。</div><div class="line">~«@a 和 @a».Str 一样 -- 返回一个字符串的数组。</div><div class="line"></div><div class="line">如果你需要对两个无限惰性列表的元素进行求和, 你可以使用 `zip` 元操作符, 使用 `@a Z+ @b` 代替 `@a »+« @b`。</div><div class="line">`Z+` 对列表进行惰性求值并按需返回它们的值。</div><div class="line">等价于  `(@a Z @b).map(* + *)`。</div><div class="line">&lt;a b c&gt; Z~ &lt;1 2 3&gt; 返回 a1 b2 c3</div><div class="line">同样地 , 交叉操作符 X 有一个等价的 元操作符</div><div class="line">&lt;a b c&gt; X~ &lt;1 2 3&gt; 返回 a1 a2 a3 b1 b2 b3 c1 c2 c3</div><div class="line"></div><div class="line">If you do need to sum the elements of two infinite lazy lists, you can use the zip meta operator</div><div class="line">Instead of @a »+« @b, you can do @a Z+ @b</div><div class="line">Z+ evaluates the lists lazily and returns its values lazily</div><div class="line">It&apos;s effectively doing (@a Z @b).map(* + *)</div><div class="line">&lt;a b c&gt; Z~ &lt;1 2 3&gt; returns a1 b2 c3</div><div class="line">Likewise, the cross operator X has a meta operator equivalent</div><div class="line">&lt;a b c&gt; X~ &lt;1 2 3&gt; returns a1 a2 a3 b1 b2 b3 c1 c2 c3</div><div class="line"></div><div class="line">另外一个作用于数组/列表的元操作符是 reduce:</div><div class="line">`[+] @a` 对 @a 的所有元素进行求和并返回和, 这在功能上等价于 `@a[0] + @a[1] + ... + @a[*-1]`</div><div class="line">任何中缀操作符都能用在 `+` 那个位置上, 显然这对无限惰性列表没有作用。</div><div class="line">但是有另外一种形式的 reduce 元操作符, 它能返回一个惰性列表。</div><div class="line">`[\*] 1..*` 返回一个惰性列表  `1, 1*2, 1*2*3, 1*2*3*4 ...`</div><div class="line">那就是说, it returns each internal step of the evaluation of [*]</div><div class="line"></div><div class="line">Another meta operator which works on arrays/lists is reduce:</div><div class="line">[+] @a sums all of the elements of @a and returns the sum</div><div class="line">It&apos;s functionally equivalent to @a[0] + @a[1] + ... + @a[*-1]</div><div class="line">Any infix operator can be used in place of + there</div><div class="line">Obviously this will not work for infinite lazy lists</div><div class="line">But there is another form of the reduce meta operator which returns a lazy list</div><div class="line">[\*] 1...* returns the lazy list 1, 1*2, 1*2*3, 1*2*3*4 ...</div><div class="line">That is to say, it returns each internal step of the evaluation of [*]</div><div class="line"></div><div class="line">其它元操作符：</div><div class="line">赋值： 传统 op= (eg +=)</div><div class="line">取反： 中缀关系操作符能用作 !op, 即 ` $a !eq $b ` 等价于 `!($a eq $b)`。</div><div class="line">反转： Rop 反转了 op 的参数, 所以 $a R- $b 和 $b - $a 相同。</div><div class="line"></div><div class="line">Other meta operators:</div><div class="line">Assignment: The traditional op= (eg +=)</div><div class="line">Negation: Infix relational operators can be used as !op</div><div class="line">That is, $a !eq $b is equivalent to !($a eq $b)</div><div class="line">Reversing: Rop reverses the arguments to op</div><div class="line">So $a R- $b is the same as $b - $a</div><div class="line"></div><div class="line">&quot;自然地&quot;, 元操作符能嵌套起来</div><div class="line">&quot;Naturally,&quot; meta operators can be nested</div><div class="line">&lt;a b c&gt; X~ &lt;1 2 3&gt;   is a1 a2 a3 b1 b2 b3 c1 c2 c3</div><div class="line">&lt;a b c&gt; RX~ &lt;1 2 3&gt;  is 1a 1b 1c 2a 2b 2c 3a 3b 3c</div><div class="line">&lt;a b c&gt; RXR~ &lt;1 2 3&gt; is a1 b1 c1 a2 b2 c2 a3 b3 c3</div><div class="line">That&apos;s one of the few useful applications of this I know of :)</div><div class="line"></div><div class="line">New operators can be defined just like any other sub</div><div class="line">multi sub infix:&lt;+&gt;(MyInt $a, MyInt $b) overloads addition for MyInt</div><div class="line">sub postfix:&lt;!&gt;(Int $a) &#123; [*] 1..$a; &#125; creates a factorial operator:</div><div class="line">5! yields 120, just as you would expect</div><div class="line">sub prefix:&lt;$$$&gt;($a) &#123; &quot;$a billion dollars&quot; &#125;</div><div class="line">$$$10 yields the string 10 billion dollars</div><div class="line">In theory, these new operators can be used with meta operators too</div><div class="line"></div><div class="line">You may have the impression that Perl 6 is operator crazy</div><div class="line">If so, you are right</div><div class="line">Part of the Perl 6 philosophy is to have a very rich set of operators</div><div class="line">It&apos;s up to programmers not to abuse this</div><div class="line">eg As an infix, + (by itself) should always refer to mathematical addition</div><div class="line">But that&apos;s a convention, not a hard technical rule of the language</div><div class="line"></div><div class="line">prefix:&lt;+&gt; is just sugar for calling an object&apos;s Numeric conversion method</div><div class="line">Operators which start with + are numeric operators</div><div class="line">For instance, +&amp; converts both its arguments to Int and does bitwise AND on them</div><div class="line">prefix:&lt;?&gt; is sugar for .Bool, and ?| converts its arguments to Bool and ORs them</div><div class="line">prefix:&lt;~&gt; is sugar for .Str, conversion to a string</div></pre></td></tr></table></figure>
<h2 id="Syntax-flexibility"><a href="#Syntax-flexibility" class="headerlink" title="Syntax flexibility"></a>Syntax flexibility</h2><hr>
<h2 id="Concurrency"><a href="#Concurrency" class="headerlink" title="Concurrency"></a>Concurrency</h2><hr>
<h2 id="Phasers"><a href="#Phasers" class="headerlink" title="Phasers"></a>Phasers</h2><hr>
<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><hr>
<h2 id="Meta-Object-Programming"><a href="#Meta-Object-Programming" class="headerlink" title="Meta-Object Programming"></a>Meta-Object Programming</h2><hr>
<h2 id="Lexing-and-Parsing"><a href="#Lexing-and-Parsing" class="headerlink" title="Lexing and Parsing"></a>Lexing and Parsing</h2><hr>
<h2 id="Roles"><a href="#Roles" class="headerlink" title="Roles"></a>Roles</h2><hr>
<p>所以到底什么是 role 呢？ 零个或多个方法和属性的集合。</p>
<p>role 不像class，它不能被实例化（如果你尝试了，会生成一个 class）。Perl 6 中 Classes 是可变的，而 roles 是不可变的。</p>
<p>声明 Roles 就像声明 Class 一样：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">role DebugLog &#123;</div><div class="line">    has @.log_lines;</div><div class="line">&#125;</div><div class="line"></div><div class="line">has $.log_size is rw = 100;</div><div class="line"></div><div class="line">method log_message($message) &#123;</div><div class="line">@!log_lines.shift if</div><div class="line">    @!log_lines.elems &gt;= $!log_size;</div><div class="line">    @!log_lines.push($message);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>使用 <code>does</code> trait 将 role 组合到 Class 中：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">class WebCrawler does DebugLog &#123;</div><div class="line">    ...</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这会把方法和属性添加到 class WebCrawler 里面去。结果就像它们起初被写到 class 中一样。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">role Bull-Like &#123;</div><div class="line">    has Bool $.castrated = False;</div><div class="line">    method steer &#123;</div><div class="line">        # Turn your bull into a steer</div><div class="line">        $!castrated = True;</div><div class="line">        return self;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">role Steerable &#123;</div><div class="line">    has Real $.direction;</div><div class="line">    method steer (Real $d = 0) &#123;</div><div class="line">        $!direction += $d;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">class Taurus does Bull-Like does Steerable &#123;</div><div class="line">    method steer ($!direction?) &#123;</div><div class="line">        self.Steerable::steer($!direction?);</div><div class="line">    &#125;</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">role Hammering &#123;</div><div class="line">    method hammer($stuff) &#123;</div><div class="line">        say &quot;You hammer on $stuff. BAM BAM BAM!&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Hammer does Hammering &#123;&#125;</div><div class="line">class Gavel  does Hammering &#123;&#125;</div><div class="line">class Mallet does Hammering &#123;&#125;</div><div class="line"></div><div class="line">my $hammer = Hammer.new;    # create a new hammer object</div><div class="line">say $hammer ~~ Hammer;      # &quot;Bool::True&quot; -- yes, this we know</div><div class="line">say $hammer ~~ Hammering;   # &quot;Bool::True&quot; -- ooh!</div><div class="line"></div><div class="line">my $unkown_object = Gavel.new;</div><div class="line">if $unkown_object ~~ Hammering &#123;</div><div class="line">    $unkown_object.hammer(&quot;that nail over there&quot;);     # will always work</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">role Serializable &#123;</div><div class="line">    method serialize() &#123;</div><div class="line">        self.perl; # very primitive serialization</div><div class="line">    &#125;</div><div class="line">    method deserialize($buf) &#123;</div><div class="line">        EVAL $buf; # reverse operation to .perl</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Point does Serializable &#123;</div><div class="line">    has $.x;</div><div class="line">    has $.y;</div><div class="line">&#125;</div><div class="line">my $p = Point.new(:x(1), :y(2));</div><div class="line">my $serialized = $p.serialize;      # method provided by the role</div><div class="line">say $serialized;</div><div class="line">my $clone-of-p = Point.deserialize($serialized);</div><div class="line">say $clone-of-p.x;      # 1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div></pre></td><td class="code"><pre><div class="line">﻿role Observable &#123;</div><div class="line">    has @!observers;</div><div class="line"></div><div class="line">    method subscribe($observer) &#123;</div><div class="line">        push @!observers, $observer;</div><div class="line">        $observer</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method unsubscribe($observer) &#123;</div><div class="line">        @!observers .= grep(&#123; $^o !=== $observer &#125;);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    method publish($obj) &#123;</div><div class="line">        @!observers&gt;&gt;.handle($obj)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class ReadLineSource does Observable &#123;</div><div class="line">    has $.fh;</div><div class="line">    method enterloop() &#123;</div><div class="line">        loop &#123;</div><div class="line">            self.publish($.fh.get());</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">multi grep($matcher, Observable $ob) &#123;</div><div class="line">    my class GrepSubscriber does Observable &#123;</div><div class="line">        has $.matcher;</div><div class="line">        method handle($obj) &#123;</div><div class="line">            if $obj ~~ $.matcher &#123;</div><div class="line">                self.publish($obj);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    $ob.subscribe(GrepSubscriber.new(:$matcher))</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $src = ReadLineSource.new(fh =&gt; $*IN);</div><div class="line">$src</div><div class="line">    ==&gt; grep(/^\d+$/)</div><div class="line">    ==&gt; into my $nums;</div><div class="line"></div><div class="line">$nums</div><div class="line">    ==&gt; grep(*.Int.is-prime)</div><div class="line">    ==&gt; call(-&gt; $p &#123; say &quot;That&apos;s prime!&quot; &#125;);</div><div class="line"></div><div class="line">$nums</div><div class="line">    ==&gt; map(-&gt; $n &#123;</div><div class="line">            state $total += $n;</div><div class="line">            $total &gt;= 100 ?? &apos;More than 100&apos; !! ()</div><div class="line">        &#125;)</div><div class="line">    ==&gt; first()</div><div class="line">    ==&gt; call(-&gt; $msg &#123; say $msg &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">role Point &#123;</div><div class="line">    has $.x;</div><div class="line">    has $.y;</div><div class="line">    method abs &#123; sqrt($.x * $.x + $.y * $.y) &#125;</div><div class="line">&#125;</div><div class="line">say Point.new(x =&gt; 6, y =&gt; 8).abs;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">role Sleeping &#123;</div><div class="line">    method lie &#123;</div><div class="line">        say &quot;Reclining horizontally...&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">role Lying &#123;</div><div class="line">    method lie &#123;</div><div class="line">        say &quot;Telling an untruth...&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># 如果解决方法同名的冲突呢？</div><div class="line"># 在 class 中定义一个同名的方法即可</div><div class="line">class SleepingLiar does Sleeping does Lying &#123;</div><div class="line">    method lie &#123;</div><div class="line">        say &quot;Lying in my sleep....&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sleep = SleepingLiar.new;</div><div class="line">$sleep.lie; # Lying in my sleep....</div><div class="line"></div><div class="line"># 调用其中之一的 roles 的 lie 方法</div><div class="line">class SleepingSheep does Sleeping does Lying &#123;</div><div class="line">    method lie &#123;</div><div class="line">        self.Sleeping::lie;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $sleepSheep = SleepingSheep.new;</div><div class="line">$sleepSheep.lie; # Reclining horizontally...</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">role Paintable &#123;</div><div class="line">    has $.colour is rw;</div><div class="line">    method paint &#123; ... &#125;</div><div class="line">&#125;</div><div class="line">class Shape &#123;</div><div class="line">    method area &#123; ... &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Rectangle is Shape does Paintable &#123;</div><div class="line">    has $.width;</div><div class="line">    has $.height;</div><div class="line">    method area &#123;</div><div class="line">        $!width * $!height;</div><div class="line">    &#125;</div><div class="line">    method paint() &#123;</div><div class="line">        for 1..$.height &#123;</div><div class="line">            say &apos;x&apos; x $.width;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">Rectangle.new(width =&gt; 8, height =&gt; 3).paint;</div><div class="line"># 这打印下面 3 行</div><div class="line">xxxxxxxx</div><div class="line">xxxxxxxx</div><div class="line">xxxxxxxx</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">role Serializable &#123;</div><div class="line">    method serialize() &#123;</div><div class="line">        self.perl; # very primitive serialization</div><div class="line">    &#125;</div><div class="line">    method deserialization-code($buf) &#123;</div><div class="line">        EVAL $buf; # reverse operation to .perl</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class Point does Serializable &#123;</div><div class="line">    has $.x;</div><div class="line">    has $.y;</div><div class="line">&#125;</div><div class="line">my $p = Point.new(:x(1), :y(2));</div><div class="line">my $serialized = $p.serialize;      # method provided by the role</div><div class="line">my $clone-of-p = Point.deserialization-code($serialized);</div><div class="line">say $clone-of-p.x;      # 1</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">role Sleeping &#123;</div><div class="line">    method lie &#123;</div><div class="line">        say &quot;Reclining horizontally...&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">role Lying &#123;</div><div class="line">    method lie &#123;</div><div class="line">        say &quot;Telling an untruth...&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">class SleepingLiar does Sleeping does Lying &#123;&#125;    # CONFLICT!</div><div class="line"></div><div class="line"># Method &apos;lie&apos; must be resolved by class SleepingLiar because it exists in multiple roles (Lying, Sleeping)</div></pre></td></tr></table></figure>
<h2 id="rosettacode"><a href="#rosettacode" class="headerlink" title="rosettacode"></a>rosettacode</h2><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"># 问题： 你有 100 扇关着的门排成一排， 然后你穿过这些门 100 次。第一次穿过的时候，穿越每一扇门， 如果门是开着的就关闭它， 如果门是关着的就打开它。第二次穿越的时候，每两扇门穿越一下，（第 2、4、6扇门）；第三次穿越的时候， 每 3 扇门（第 3、6、9），等等， 直到你穿过第 100 扇门为止。</div><div class="line"># 问： 最后一次穿过门之后， 每扇门的状态是开是关？</div><div class="line"># 提示： 剩下开着的门就是那些能开方的整数the only doors that remain open are whose numbers are perfect squares of integers</div><div class="line">#`(</div><div class="line">my @doors = False xx 101;</div><div class="line"></div><div class="line">($_ = !$_ for @doors[0, * + $_ ...^ * &gt; 100]) for 1..100;</div><div class="line"></div><div class="line">say &quot;Door $_ is &quot;, &lt;closed open&gt;[ @doors[$_] ] for 1..100;</div><div class="line">)</div><div class="line"></div><div class="line">say &quot;Door $_ is open&quot; for map &#123;$^n ** 2&#125;, 1..10;</div><div class="line"></div><div class="line">say &quot;Door $_ is open&quot; for 1..10 X** 2;</div><div class="line"></div><div class="line">say &quot;Door $_ is &quot;, &lt;closed open&gt;[.sqrt == .sqrt.floor] for 1..100;</div><div class="line"></div><div class="line"># « U+00AB  , » U+00BB  Vim =&gt; Ctrl+V =&gt; u =&gt; 00AB</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># Works with: Rakudo Star version 2010.08</div><div class="line">for 10 ... 0 &#123;</div><div class="line">    .say;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># Works with: Rakudo Star version 2010.08</div><div class="line">loop &#123;</div><div class="line">    say &apos;SPAM&apos;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># In addition, there are various ways of writing lazy, infinite lists in Perl 6:</div><div class="line">print &quot;SPAM\n&quot; xx *;      # repetition operator</div><div class="line">print &quot;SPAM\n&quot;, ~* ... *; # sequence operator</div><div class="line">map &#123;say &quot;SPAM&quot;&#125;, ^Inf;   # upto operator</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"># A list comprehension is a special syntax in some programming languages to describe lists. It is similar to the way mathematicians describe sets, with a set comprehension, hence the name.</div><div class="line"></div><div class="line"># Some attributes of a list comprehension are that:</div><div class="line"># 1. They should be distinct from (nested) for loops within the syntax of the language.</div><div class="line"># 2. They should return either a list or an iterator (something that returns successive members of a collection, in order).</div><div class="line"># 3. The syntax has parts corresponding to that of set-builder notation.</div><div class="line"></div><div class="line"># Write a list comprehension that builds the list of all Pythagorean triples with elements between 1 and n. If the language has multiple ways for expressing such a construct (for example, direct list comprehensions and generators), write one example for each.</div><div class="line"></div><div class="line">use v6;</div><div class="line"></div><div class="line">my $n = 20;</div><div class="line">my @list := gather for 1..$n -&gt; $x &#123;</div><div class="line">         for $x..$n -&gt; $y &#123;</div><div class="line">           for $y..$n -&gt; $z &#123;</div><div class="line">             take $x,$y,$z if $x*$x + $y*$y == $z*$z;</div><div class="line">           &#125;</div><div class="line">         &#125;</div><div class="line">       &#125;</div><div class="line">.say for  @list;</div><div class="line"></div><div class="line"># Note that gather/take is the primitive in Perl 6 corresponding to generators or coroutines in other languages. It is not, however, tied to function call syntax in Perl 6. We can get away with that because lists are lazy, and the demand for more of the list is implicit; it does not need to be driven by function calls.</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"># Loop over multiple arrays (or lists or tuples or whatever they&apos;re called in your language) and print the ith element of each. Use your language&apos;s &quot;for each&quot; loop if it has one, otherwise iterate through the collection in order with some other loop.</div><div class="line"></div><div class="line"># For this example, loop over the arrays (a,b,c), (A,B,C) and (1,2,3) to produce the output</div><div class="line"># aA1</div><div class="line"># bB2</div><div class="line"># cC3</div><div class="line"></div><div class="line">for &lt;a b c&gt; Z &lt;A B C&gt; Z 1, 2, 3 -&gt; $x, $y, $z &#123;</div><div class="line">   say $x, $y, $z;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># The Z operator stops emitting items as soon as the shortest input list is exhausted. However, short lists are easily extended by replicating all or part of the list, or by appending any kind of lazy list generator to supply default values as necessary.</div><div class="line"></div><div class="line"># Note that we can also factor out the concatenation by making the Z metaoperator apply the ~ concatenation operator across each triple:</div><div class="line">for &lt;a b c&gt; Z~ &lt;A B C&gt; Z~ 1, 2, 3 -&gt; $line &#123;</div><div class="line">   say $line;</div><div class="line">&#125;</div><div class="line"></div><div class="line"># We could also use the zip-to-string with the reduction metaoperator:</div><div class="line">.say for [Z~] [&lt;a b c&gt;], [&lt;A B C&gt;], [1,2,3]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"># 给定一组排好序的数， 如果数字是连续的，就用 - 符号连接 头和尾</div><div class="line"># 例如 -6, -3, -2, -1, 0, 1, 3, 4, 5, 7, 8, 9, 10, 11, 14, 15, 17, 18, 19, 20</div><div class="line"># 处理后变为： -6,-3-1,3-5,7-11,14,15,17-20</div><div class="line"># Task:编写一个函数， 将范围连接起来</div><div class="line">#  0,  1,  2,  4,  6,  7,  8, 11, 12, 14,</div><div class="line">#  15, 16, 17, 18, 19, 20, 21, 22, 23, 24,</div><div class="line">#  25, 27, 28, 29, 30, 31, 32, 33, 35, 36,</div><div class="line">#  37, 38, 39</div><div class="line"></div><div class="line">sub range-extraction (*@ints) &#123;</div><div class="line">    my $prev = NaN;</div><div class="line">    my @ranges;</div><div class="line"></div><div class="line">    for @ints -&gt; $int &#123;</div><div class="line">        if $int == $prev + 1 &#123;</div><div class="line">            @ranges[*-1].push: $int;</div><div class="line">        &#125;</div><div class="line">        else &#123;</div><div class="line">            @ranges.push: [$int];</div><div class="line">        &#125;</div><div class="line">        $prev = $int;</div><div class="line">    &#125;</div><div class="line">    join &apos;,&apos;, @ranges.map: -&gt; @r &#123; @r &gt; 2 ?? &quot;@r[0]-@r[*-1]&quot; !! @r &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">say range-extraction</div><div class="line">    -6, -3, -2, -1, 0, 1, 3, 4, 5, 7, 8, 9, 10, 11, 14, 15, 17, 18, 19, 20;</div><div class="line"></div><div class="line">say range-extraction</div><div class="line">    0,  1,  2,  4,  6,  7,  8, 11, 12, 14,</div><div class="line">    15, 16, 17, 18, 19, 20, 21, 22, 23, 24,</div><div class="line">    25, 27, 28, 29, 30, 31, 32, 33, 35, 36,</div><div class="line">    37, 38, 39;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># The sleep function argument is in units of seconds, but these may be fractional (to the limits of your system&apos;s clock).</div><div class="line">my $sec = prompt(&quot;Sleep for how many microfortnights? &quot;) * 1.2096;</div><div class="line">say &quot;Sleeping...&quot;;</div><div class="line">sleep $sec;</div><div class="line">say &quot;Awake!&quot;;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"># Sort an array of composite structures by a key. For example, if you define a composite structure that presents a name-value pair (in pseudocode):</div><div class="line"># Define structure pair such that:</div><div class="line">   # name as a string</div><div class="line">   # value as a string</div><div class="line"></div><div class="line"></div><div class="line"># and an array of such pairs:</div><div class="line"># x: array of pairs</div><div class="line"></div><div class="line"></div><div class="line"># then define a sort routine that sorts the array x by the key name.</div><div class="line"></div><div class="line"># This task can always be accomplished with Sorting Using a Custom Comparator. If your language is not listed here, please see the other article.</div><div class="line"></div><div class="line"># Works with: Rakudo Star version 2010.08</div><div class="line"></div><div class="line">my class Employee &#123;</div><div class="line">   has Str $.name;</div><div class="line">   has Rat $.wage;</div><div class="line">&#125;</div><div class="line"></div><div class="line">my $boss     = Employee.new( name =&gt; &quot;Frank Myers&quot;     , wage =&gt; 6755.85 );</div><div class="line">my $driver   = Employee.new( name =&gt; &quot;Aaron Fast&quot;      , wage =&gt; 2530.40 );</div><div class="line">my $worker   = Employee.new( name =&gt; &quot;John Dude&quot;       , wage =&gt; 2200.00 );</div><div class="line">my $salesman = Employee.new( name =&gt; &quot;Frank Mileeater&quot; , wage =&gt; 4590.12 );</div><div class="line"></div><div class="line">my @team = $boss, $driver, $worker, $salesman;</div><div class="line"></div><div class="line">my @orderedByName = @team.sort( *.name )&gt;&gt;.name;</div><div class="line">my @orderedByWage = @team.sort( *.wage )&gt;&gt;.name;</div><div class="line"></div><div class="line">say &quot;Team ordered by name (ascending order):&quot;;</div><div class="line">say @orderedByName.join(&apos;  &apos;);</div><div class="line">say &quot;Team ordered by wage (ascending order):&quot;;</div><div class="line">say @orderedByWage.join(&apos;  &apos;);</div><div class="line"></div><div class="line"># this produces the following output:</div><div class="line"># Team ordered by name (ascending order):</div><div class="line"># Aaron Fast   Frank Mileeater   Frank Myers   John Dude</div><div class="line"># Team ordered by wage (ascending order):</div><div class="line"># John Dude   Aaron Fast   Frank Mileeater   Frank Myers</div><div class="line"></div><div class="line"></div><div class="line"># Note that when the sort receives a unary function, it automatically generates an appropriate comparison function based on the type of the data.</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>
    
    <div>
      
        
<div style="text-align:center;color: #ccc;font-size:15px;">
------ Young For Perl 6! ------</div>

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Examples/" rel="tag">#Examples</a>
          
            <a href="/tags/特性/" rel="tag">#特性</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/04/12/Perl6中的函数签名/" rel="next" title="Perl 6 中的函数签名">
                <i class="fa fa-chevron-left"></i> Perl 6 中的函数签名
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/04/25/Meta-Operator/" rel="prev" title="Meta Operator">
                Meta Operator <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
        <div class="ds-share flat" data-thread-key="2016/04/22/Perl6中的特性-一/"
     data-title="Perl 6 中的特性(一)"
     data-content=""
     data-url="https://ohmycloud.github.io/2016/04/22/Perl6中的特性-一/">
  <div class="ds-share-inline">
    <ul  class="ds-share-icons-16">

      <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
      <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
      <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
      <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
      <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>

    </ul>
    <div class="ds-share-icons-more">
    </div>
  </div>
</div>
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2016/04/22/Perl6中的特性-一/"
           data-title="Perl 6 中的特性(一)" data-url="https://ohmycloud.github.io/2016/04/22/Perl6中的特性-一/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="焉知非鱼" />
          <p class="site-author-name" itemprop="name">焉知非鱼</p>
          <p class="site-description motion-element" itemprop="description">Young For Perl 6</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">161</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">177</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/ohmycloud" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/740011611" target="_blank" title="weibo">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://www.jianshu.com/u/9b20c7d63b77" target="_blank" title="简书">
                  
                    <i class="fa fa-fw fa-location-arrow"></i>
                  
                  简书
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://perl6.org/" target="_blank" title="Perl 6">
                  
                    <i class="fa fa-fw fa-paper-plane"></i>
                  
                  Perl 6
                </a>
              </span>
            
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#基础"><span class="nav-number">1.</span> <span class="nav-text">基础</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#数组"><span class="nav-number">1.1.</span> <span class="nav-text">数组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hash"><span class="nav-number">1.2.</span> <span class="nav-text">Hash</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bind"><span class="nav-number">1.3.</span> <span class="nav-text">Bind</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IO"><span class="nav-number">2.</span> <span class="nav-text">IO</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Classes"><span class="nav-number">3.</span> <span class="nav-text">Classes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Junctions"><span class="nav-number">4.</span> <span class="nav-text">Junctions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lazy-List"><span class="nav-number">5.</span> <span class="nav-text">Lazy List</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Loops"><span class="nav-number">6.</span> <span class="nav-text">Loops</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Main"><span class="nav-number">7.</span> <span class="nav-text">Main</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Types"><span class="nav-number">8.</span> <span class="nav-text">Types</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Sort"><span class="nav-number">9.</span> <span class="nav-text">Sort</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Subset"><span class="nav-number">10.</span> <span class="nav-text">Subset</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Traits"><span class="nav-number">11.</span> <span class="nav-text">Traits</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Twigils"><span class="nav-number">12.</span> <span class="nav-text">Twigils</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Whatever"><span class="nav-number">13.</span> <span class="nav-text">Whatever</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#When"><span class="nav-number">14.</span> <span class="nav-text">When</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Smart-Matching"><span class="nav-number">15.</span> <span class="nav-text">Smart-Matching</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Regexes"><span class="nav-number">16.</span> <span class="nav-text">Regexes</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Subroutine"><span class="nav-number">17.</span> <span class="nav-text">Subroutine</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Signatures"><span class="nav-number">18.</span> <span class="nav-text">Signatures</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Built-in-types-and-functions"><span class="nav-number">19.</span> <span class="nav-text">Built-in types and functions</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#classify"><span class="nav-number">19.1.</span> <span class="nav-text">.classify</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#pick-and-roll"><span class="nav-number">19.2.</span> <span class="nav-text">.pick and .roll</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sort"><span class="nav-number">19.3.</span> <span class="nav-text">.sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#操作符重载"><span class="nav-number">19.4.</span> <span class="nav-text">操作符重载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Z"><span class="nav-number">19.5.</span> <span class="nav-text">Z</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#infix-lt-…-gt"><span class="nav-number">19.6.</span> <span class="nav-text">infix:<…></span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Chained-Comparisons"><span class="nav-number">20.</span> <span class="nav-text">Chained Comparisons</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Muti-dispatch"><span class="nav-number">21.</span> <span class="nav-text">Muti dispatch</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Module-management"><span class="nav-number">22.</span> <span class="nav-text">Module management</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Native-Library-Calls"><span class="nav-number">23.</span> <span class="nav-text">Native Library Calls</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Operators"><span class="nav-number">24.</span> <span class="nav-text">Operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Awesome-Operators"><span class="nav-number">25.</span> <span class="nav-text">Awesome Operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Junctions-1"><span class="nav-number">26.</span> <span class="nav-text">Junctions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Feeds"><span class="nav-number">27.</span> <span class="nav-text">Feeds</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hyper-Operator"><span class="nav-number">28.</span> <span class="nav-text">Hyper Operator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meta-Operators"><span class="nav-number">29.</span> <span class="nav-text">Meta Operators</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Syntax-flexibility"><span class="nav-number">30.</span> <span class="nav-text">Syntax flexibility</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Concurrency"><span class="nav-number">31.</span> <span class="nav-text">Concurrency</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Phasers"><span class="nav-number">32.</span> <span class="nav-text">Phasers</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc"><span class="nav-number">33.</span> <span class="nav-text">Misc</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meta-Object-Programming"><span class="nav-number">34.</span> <span class="nav-text">Meta-Object Programming</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Lexing-and-Parsing"><span class="nav-number">35.</span> <span class="nav-text">Lexing and Parsing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Roles"><span class="nav-number">36.</span> <span class="nav-text">Roles</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#rosettacode"><span class="nav-number">37.</span> <span class="nav-text">rosettacode</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">焉知非鱼</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  托管在 -
  <a class="theme-link" href="https://github.com/ohmycloud/ohmycloud.github.io">
    Github
  </a>
  &nbsp; | &nbsp;
</div>

<div class="theme-info">
 <a class="51-img" href="/images/footer.gif" target="_blank"><img alt="统计" src="/images/footer.gif"  align="right" /></a>
<div>
        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"chenyf"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
    <script src="/vendors/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  






  
  
  

  

  

</body>
</html>
